{"version":3,"file":"main.nodejs.js","mappings":"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","sources":["../node_modules/@scrypted/sdk/dist/src/index.js","../node_modules/@scrypted/sdk/dist/src/settings-mixin.js","../node_modules/@scrypted/sdk/dist/src/storage-settings.js","../node_modules/@scrypted/sdk/dist/src|sync","../node_modules/@scrypted/sdk/dist/types/gen/index.js","../../scrypted-homeassistant/src/unitConverter.ts","../src/cameraMixin.ts","../src/main.ts","../src/utils.ts","../external node-commonjs \"module\"","../webpack/bootstrap","../webpack/runtime/hasOwnProperty shorthand","../webpack/startup"],"sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sdk = exports.MixinDeviceBase = exports.ScryptedDeviceBase = void 0;\n__exportStar(require(\"../types/gen/index\"), exports);\nconst index_1 = require(\"../types/gen/index\");\nconst module_1 = require(\"module\");\n/**\n * @category Core Reference\n */\nclass ScryptedDeviceBase extends index_1.DeviceBase {\n    constructor(nativeId) {\n        super();\n        this.nativeId = nativeId;\n    }\n    get storage() {\n        if (!this._storage) {\n            this._storage = exports.sdk.deviceManager.getDeviceStorage(this.nativeId);\n        }\n        return this._storage;\n    }\n    get log() {\n        if (!this._log) {\n            this._log = exports.sdk.deviceManager.getDeviceLogger(this.nativeId);\n        }\n        return this._log;\n    }\n    get console() {\n        if (!this._console) {\n            this._console = exports.sdk.deviceManager.getDeviceConsole(this.nativeId);\n        }\n        return this._console;\n    }\n    async createMediaObject(data, mimeType) {\n        return exports.sdk.mediaManager.createMediaObject(data, mimeType, {\n            sourceId: this.id,\n        });\n    }\n    getMediaObjectConsole(mediaObject) {\n        if (typeof mediaObject.sourceId !== 'string')\n            return this.console;\n        return exports.sdk.deviceManager.getMixinConsole(mediaObject.sourceId, this.nativeId);\n    }\n    _lazyLoadDeviceState() {\n        if (!this._deviceState) {\n            if (this.nativeId) {\n                this._deviceState = exports.sdk.deviceManager.getDeviceState(this.nativeId);\n            }\n            else {\n                this._deviceState = exports.sdk.deviceManager.getDeviceState();\n            }\n        }\n    }\n    /**\n     * Fire an event for this device.\n     */\n    onDeviceEvent(eventInterface, eventData) {\n        return exports.sdk.deviceManager.onDeviceEvent(this.nativeId, eventInterface, eventData);\n    }\n}\nexports.ScryptedDeviceBase = ScryptedDeviceBase;\n/**\n * @category Mixin Reference\n */\nclass MixinDeviceBase extends index_1.DeviceBase {\n    constructor(options) {\n        super();\n        this._listeners = new Set();\n        this.mixinDevice = options.mixinDevice;\n        this.mixinDeviceInterfaces = options.mixinDeviceInterfaces;\n        this.mixinStorageSuffix = options.mixinStorageSuffix;\n        this._deviceState = options.mixinDeviceState;\n        this.nativeId = exports.sdk.systemManager.getDeviceById(this.id).nativeId;\n        this.mixinProviderNativeId = options.mixinProviderNativeId;\n        // RpcProxy will trap all properties, and the following check/hack will determine\n        // if the device state came from another node worker thread.\n        // This should ultimately be discouraged and warned at some point in the future.\n        if (this._deviceState.__rpcproxy_traps_all_properties && typeof this._deviceState.id === 'string') {\n            this._deviceState = exports.sdk.deviceManager.createDeviceState(this._deviceState.id, this._deviceState.setState);\n        }\n    }\n    get storage() {\n        if (!this._storage) {\n            const mixinStorageSuffix = this.mixinStorageSuffix;\n            const mixinStorageKey = this.id + (mixinStorageSuffix ? ':' + mixinStorageSuffix : '');\n            this._storage = exports.sdk.deviceManager.getMixinStorage(mixinStorageKey, this.mixinProviderNativeId);\n        }\n        return this._storage;\n    }\n    get console() {\n        if (!this._console) {\n            if (exports.sdk.deviceManager.getMixinConsole)\n                this._console = exports.sdk.deviceManager.getMixinConsole(this.id, this.mixinProviderNativeId);\n            else\n                this._console = exports.sdk.deviceManager.getDeviceConsole(this.mixinProviderNativeId);\n        }\n        return this._console;\n    }\n    async createMediaObject(data, mimeType) {\n        return exports.sdk.mediaManager.createMediaObject(data, mimeType, {\n            sourceId: this.id,\n        });\n    }\n    getMediaObjectConsole(mediaObject) {\n        if (typeof mediaObject.sourceId !== 'string')\n            return this.console;\n        return exports.sdk.deviceManager.getMixinConsole(mediaObject.sourceId, this.mixinProviderNativeId);\n    }\n    /**\n     * Fire an event for this device.\n     */\n    onDeviceEvent(eventInterface, eventData) {\n        return exports.sdk.deviceManager.onMixinEvent(this.id, this, eventInterface, eventData);\n    }\n    _lazyLoadDeviceState() {\n    }\n    manageListener(listener) {\n        this._listeners.add(listener);\n    }\n    release() {\n        for (const l of this._listeners) {\n            l.removeListener();\n        }\n    }\n}\nexports.MixinDeviceBase = MixinDeviceBase;\n(function () {\n    function _createGetState(state) {\n        return function () {\n            this._lazyLoadDeviceState();\n            // @ts-ignore: accessing private property\n            return this._deviceState?.[state];\n        };\n    }\n    function _createSetState(state) {\n        return function (value) {\n            this._lazyLoadDeviceState();\n            // @ts-ignore: accessing private property\n            if (!this._deviceState) {\n                console.warn('device state is unavailable. the device must be discovered with deviceManager.onDeviceDiscovered or deviceManager.onDevicesChanged before the state can be set.');\n            }\n            else {\n                // @ts-ignore: accessing private property\n                this._deviceState[state] = value;\n            }\n        };\n    }\n    for (const field of Object.values(index_1.ScryptedInterfaceProperty)) {\n        if (field === index_1.ScryptedInterfaceProperty.nativeId)\n            continue;\n        Object.defineProperty(ScryptedDeviceBase.prototype, field, {\n            set: _createSetState(field),\n            get: _createGetState(field),\n        });\n        Object.defineProperty(MixinDeviceBase.prototype, field, {\n            set: _createSetState(field),\n            get: _createGetState(field),\n        });\n    }\n})();\nexports.sdk = {};\ntry {\n    let loaded = false;\n    try {\n        // todo: remove usage of process.env.SCRYPTED_SDK_MODULE, only existed in prerelease builds.\n        // import.meta is not a reliable way to detect es module support in webpack since webpack\n        // evaluates that to true at runtime.\n        const esModule = process.env.SCRYPTED_SDK_ES_MODULE || process.env.SCRYPTED_SDK_MODULE;\n        const cjsModule = process.env.SCRYPTED_SDK_CJS_MODULE || process.env.SCRYPTED_SDK_MODULE;\n        // @ts-expect-error\n        if (esModule && typeof import.meta !== 'undefined') {\n            // @ts-expect-error\n            const require = (0, module_1.createRequire)(import.meta.url);\n            const sdkModule = require(esModule);\n            Object.assign(exports.sdk, sdkModule.getScryptedStatic());\n            loaded = true;\n        }\n        else if (cjsModule) {\n            // @ts-expect-error\n            if (typeof __non_webpack_require__ !== 'undefined') {\n                // @ts-expect-error\n                const sdkModule = __non_webpack_require__(process.env.SCRYPTED_SDK_MODULE);\n                Object.assign(exports.sdk, sdkModule.getScryptedStatic());\n                loaded = true;\n            }\n            else {\n                const sdkModule = require(cjsModule);\n                Object.assign(exports.sdk, sdkModule.getScryptedStatic());\n                loaded = true;\n            }\n        }\n    }\n    catch (e) {\n        console.warn(\"failed to load sdk module\", e);\n        throw e;\n    }\n    if (!loaded) {\n        let runtimeAPI;\n        try {\n            runtimeAPI = pluginRuntimeAPI;\n        }\n        catch (e) {\n        }\n        Object.assign(exports.sdk, {\n            log: deviceManager.getDeviceLogger(undefined),\n            deviceManager,\n            endpointManager,\n            mediaManager,\n            systemManager,\n            pluginHostAPI,\n            ...runtimeAPI,\n        });\n    }\n    try {\n        exports.sdk.systemManager.setScryptedInterfaceDescriptors?.(index_1.TYPES_VERSION, index_1.ScryptedInterfaceDescriptors)?.catch(() => { });\n    }\n    catch (e) {\n    }\n}\ncatch (e) {\n    console.error('sdk initialization error, import @scrypted/types or use @scrypted/client instead', e);\n}\nexports.default = exports.sdk;\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SettingsMixinDeviceBase = void 0;\nconst _1 = __importStar(require(\".\"));\nconst { deviceManager } = _1.default;\nclass SettingsMixinDeviceBase extends _1.MixinDeviceBase {\n    constructor(options) {\n        super(options);\n        this.settingsGroup = options.group;\n        this.settingsGroupKey = options.groupKey;\n        process.nextTick(() => deviceManager.onMixinEvent(this.id, this, _1.ScryptedInterface.Settings, null));\n    }\n    async getSettings() {\n        const settingsPromise = this.mixinDeviceInterfaces.includes(_1.ScryptedInterface.Settings) ? this.mixinDevice.getSettings() : undefined;\n        const mixinSettingsPromise = this.getMixinSettings();\n        const allSettings = [];\n        try {\n            const settings = (await settingsPromise) || [];\n            allSettings.push(...settings);\n        }\n        catch (e) {\n            const name = this.name;\n            const description = `${name} Extension settings failed to load.`;\n            this.console.error(description, e);\n            allSettings.push({\n                key: Math.random().toString(),\n                title: name,\n                value: 'Settings Error',\n                group: 'Errors',\n                description,\n                readonly: true,\n            });\n        }\n        try {\n            const mixinSettings = (await mixinSettingsPromise) || [];\n            for (const setting of mixinSettings) {\n                setting.group = setting.group || this.settingsGroup;\n                setting.key = this.settingsGroupKey + ':' + setting.key;\n            }\n            allSettings.push(...mixinSettings);\n        }\n        catch (e) {\n            const name = deviceManager.getDeviceState(this.mixinProviderNativeId).name;\n            const description = `${name} Extension settings failed to load.`;\n            this.console.error(description, e);\n            allSettings.push({\n                key: Math.random().toString(),\n                title: name,\n                value: 'Settings Error',\n                group: 'Errors',\n                description,\n                readonly: true,\n            });\n        }\n        return allSettings;\n    }\n    async putSetting(key, value) {\n        const prefix = this.settingsGroupKey + ':';\n        if (!key?.startsWith(prefix)) {\n            return this.mixinDevice.putSetting(key, value);\n        }\n        if (!await this.putMixinSetting(key.substring(prefix.length), value))\n            deviceManager.onMixinEvent(this.id, this, _1.ScryptedInterface.Settings, null);\n    }\n    async release() {\n        await deviceManager.onMixinEvent(this.id, this, _1.ScryptedInterface.Settings, null);\n    }\n}\nexports.SettingsMixinDeviceBase = SettingsMixinDeviceBase;\n//# sourceMappingURL=settings-mixin.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.StorageSettings = void 0;\nconst _1 = __importStar(require(\".\"));\nconst { systemManager } = _1.default;\nfunction parseValue(value, setting, readDefaultValue, rawDevice) {\n    if (value === null || value === undefined) {\n        return readDefaultValue();\n    }\n    const type = setting.multiple ? 'array' : setting.type;\n    if (type === 'boolean') {\n        if (value === 'true')\n            return true;\n        if (value === 'false')\n            return false;\n        return readDefaultValue() || false;\n    }\n    if (type === 'number') {\n        const n = parseFloat(value);\n        if (!isNaN(n))\n            return n;\n        return readDefaultValue() || 0;\n    }\n    if (type === 'integer') {\n        const n = parseInt(value);\n        if (!isNaN(n))\n            return n;\n        return readDefaultValue() || 0;\n    }\n    if (type === 'array') {\n        if (!value)\n            return readDefaultValue() || [];\n        try {\n            return JSON.parse(value);\n        }\n        catch (e) {\n            return readDefaultValue() || [];\n        }\n    }\n    if (type === 'device') {\n        if (rawDevice)\n            return value;\n        return systemManager.getDeviceById(value) || systemManager.getDeviceById(readDefaultValue());\n    }\n    // string type, so check if it is json.\n    if (value && setting.json) {\n        try {\n            return JSON.parse(value);\n        }\n        catch (e) {\n            return readDefaultValue();\n        }\n    }\n    return value || readDefaultValue();\n}\nclass StorageSettings {\n    constructor(device, settings) {\n        this.device = device;\n        this.settings = settings;\n        this.values = {};\n        this.hasValue = {};\n        for (const key of Object.keys(settings)) {\n            const setting = settings[key];\n            const rawGet = () => this.getItem(key);\n            let get;\n            if (setting.type !== 'clippath') {\n                get = rawGet;\n            }\n            else {\n                // maybe need a mapPut. clippath is the only complex type at the moment.\n                get = () => {\n                    try {\n                        return JSON.parse(rawGet());\n                    }\n                    catch (e) {\n                    }\n                };\n            }\n            Object.defineProperty(this.values, key, {\n                get,\n                set: value => this.putSetting(key, value),\n                enumerable: true,\n            });\n            Object.defineProperty(this.hasValue, key, {\n                get: () => this.device.storage.getItem(key) != null,\n                enumerable: true,\n            });\n        }\n    }\n    get keys() {\n        const ret = {};\n        for (const key of Object.keys(this.settings)) {\n            ret[key] = key;\n        }\n        return ret;\n    }\n    async getSettings() {\n        const onGet = await this.options?.onGet?.();\n        const ret = [];\n        for (const [key, setting] of Object.entries(this.settings)) {\n            let s = Object.assign({}, setting);\n            if (onGet?.[key])\n                s = Object.assign(s, onGet[key]);\n            if (s.onGet)\n                s = Object.assign(s, await s.onGet());\n            if (s.hide || await this.options?.hide?.[key]?.())\n                continue;\n            s.key = key;\n            s.value = this.getItemInternal(key, s, true);\n            if (typeof s.deviceFilter === 'function')\n                s.deviceFilter = s.deviceFilter.toString();\n            ret.push(s);\n            delete s.onPut;\n            delete s.onGet;\n            delete s.mapPut;\n            delete s.mapGet;\n        }\n        return ret;\n    }\n    async putSetting(key, value) {\n        const setting = this.settings[key];\n        let oldValue;\n        if (setting)\n            oldValue = this.getItemInternal(key, setting);\n        return this.putSettingInternal(setting, oldValue, key, value);\n    }\n    putSettingInternal(setting, oldValue, key, value) {\n        if (!setting?.noStore) {\n            if (setting?.mapPut)\n                value = setting.mapPut(oldValue, value);\n            // nullish values should be removed, since Storage can't persist them correctly.\n            if (value == null)\n                this.device.storage.removeItem(key);\n            else if (typeof value === 'object')\n                this.device.storage.setItem(key, JSON.stringify(value));\n            else\n                this.device.storage.setItem(key, value?.toString());\n        }\n        setting?.onPut?.(oldValue, value);\n        if (!setting?.hide)\n            this.device.onDeviceEvent(_1.ScryptedInterface.Settings, undefined);\n    }\n    getItemInternal(key, setting, rawDevice) {\n        if (!setting)\n            return this.device.storage.getItem(key);\n        const readDefaultValue = () => {\n            if (setting.persistedDefaultValue != null) {\n                this.putSettingInternal(setting, undefined, key, setting.persistedDefaultValue);\n                return setting.persistedDefaultValue;\n            }\n            return setting.defaultValue;\n        };\n        const ret = parseValue(this.device.storage.getItem(key), setting, readDefaultValue, rawDevice);\n        return setting.mapGet ? setting.mapGet(ret) : ret;\n    }\n    getItem(key) {\n        return this.getItemInternal(key, this.settings[key]);\n    }\n}\nexports.StorageSettings = StorageSettings;\n//# sourceMappingURL=storage-settings.js.map","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 891;\nmodule.exports = webpackEmptyContext;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ScryptedMimeTypes = exports.ScryptedInterface = exports.MediaPlayerState = exports.SecuritySystemObstruction = exports.SecuritySystemMode = exports.AirQuality = exports.AirPurifierMode = exports.AirPurifierStatus = exports.ChargeState = exports.LockState = exports.PanTiltZoomMovement = exports.ThermostatMode = exports.TemperatureUnit = exports.FanMode = exports.HumidityMode = exports.ScryptedDeviceType = exports.ScryptedInterfaceDescriptors = exports.ScryptedInterfaceMethod = exports.ScryptedInterfaceProperty = exports.DeviceBase = exports.TYPES_VERSION = void 0;\nexports.TYPES_VERSION = \"0.3.108\";\nclass DeviceBase {\n}\nexports.DeviceBase = DeviceBase;\nvar ScryptedInterfaceProperty;\n(function (ScryptedInterfaceProperty) {\n    ScryptedInterfaceProperty[\"id\"] = \"id\";\n    ScryptedInterfaceProperty[\"info\"] = \"info\";\n    ScryptedInterfaceProperty[\"interfaces\"] = \"interfaces\";\n    ScryptedInterfaceProperty[\"mixins\"] = \"mixins\";\n    ScryptedInterfaceProperty[\"name\"] = \"name\";\n    ScryptedInterfaceProperty[\"nativeId\"] = \"nativeId\";\n    ScryptedInterfaceProperty[\"pluginId\"] = \"pluginId\";\n    ScryptedInterfaceProperty[\"providedInterfaces\"] = \"providedInterfaces\";\n    ScryptedInterfaceProperty[\"providedName\"] = \"providedName\";\n    ScryptedInterfaceProperty[\"providedRoom\"] = \"providedRoom\";\n    ScryptedInterfaceProperty[\"providedType\"] = \"providedType\";\n    ScryptedInterfaceProperty[\"providerId\"] = \"providerId\";\n    ScryptedInterfaceProperty[\"room\"] = \"room\";\n    ScryptedInterfaceProperty[\"type\"] = \"type\";\n    ScryptedInterfaceProperty[\"scryptedRuntimeArguments\"] = \"scryptedRuntimeArguments\";\n    ScryptedInterfaceProperty[\"on\"] = \"on\";\n    ScryptedInterfaceProperty[\"brightness\"] = \"brightness\";\n    ScryptedInterfaceProperty[\"colorTemperature\"] = \"colorTemperature\";\n    ScryptedInterfaceProperty[\"rgb\"] = \"rgb\";\n    ScryptedInterfaceProperty[\"hsv\"] = \"hsv\";\n    ScryptedInterfaceProperty[\"buttons\"] = \"buttons\";\n    ScryptedInterfaceProperty[\"sensors\"] = \"sensors\";\n    ScryptedInterfaceProperty[\"running\"] = \"running\";\n    ScryptedInterfaceProperty[\"paused\"] = \"paused\";\n    ScryptedInterfaceProperty[\"docked\"] = \"docked\";\n    ScryptedInterfaceProperty[\"temperatureSetting\"] = \"temperatureSetting\";\n    ScryptedInterfaceProperty[\"temperature\"] = \"temperature\";\n    ScryptedInterfaceProperty[\"temperatureUnit\"] = \"temperatureUnit\";\n    ScryptedInterfaceProperty[\"humidity\"] = \"humidity\";\n    ScryptedInterfaceProperty[\"audioVolumes\"] = \"audioVolumes\";\n    ScryptedInterfaceProperty[\"recordingActive\"] = \"recordingActive\";\n    ScryptedInterfaceProperty[\"ptzCapabilities\"] = \"ptzCapabilities\";\n    ScryptedInterfaceProperty[\"lockState\"] = \"lockState\";\n    ScryptedInterfaceProperty[\"entryOpen\"] = \"entryOpen\";\n    ScryptedInterfaceProperty[\"batteryLevel\"] = \"batteryLevel\";\n    ScryptedInterfaceProperty[\"chargeState\"] = \"chargeState\";\n    ScryptedInterfaceProperty[\"online\"] = \"online\";\n    ScryptedInterfaceProperty[\"fromMimeType\"] = \"fromMimeType\";\n    ScryptedInterfaceProperty[\"toMimeType\"] = \"toMimeType\";\n    ScryptedInterfaceProperty[\"converters\"] = \"converters\";\n    ScryptedInterfaceProperty[\"binaryState\"] = \"binaryState\";\n    ScryptedInterfaceProperty[\"tampered\"] = \"tampered\";\n    ScryptedInterfaceProperty[\"sleeping\"] = \"sleeping\";\n    ScryptedInterfaceProperty[\"powerDetected\"] = \"powerDetected\";\n    ScryptedInterfaceProperty[\"audioDetected\"] = \"audioDetected\";\n    ScryptedInterfaceProperty[\"motionDetected\"] = \"motionDetected\";\n    ScryptedInterfaceProperty[\"ambientLight\"] = \"ambientLight\";\n    ScryptedInterfaceProperty[\"occupied\"] = \"occupied\";\n    ScryptedInterfaceProperty[\"flooded\"] = \"flooded\";\n    ScryptedInterfaceProperty[\"ultraviolet\"] = \"ultraviolet\";\n    ScryptedInterfaceProperty[\"luminance\"] = \"luminance\";\n    ScryptedInterfaceProperty[\"position\"] = \"position\";\n    ScryptedInterfaceProperty[\"securitySystemState\"] = \"securitySystemState\";\n    ScryptedInterfaceProperty[\"pm10Density\"] = \"pm10Density\";\n    ScryptedInterfaceProperty[\"pm25Density\"] = \"pm25Density\";\n    ScryptedInterfaceProperty[\"vocDensity\"] = \"vocDensity\";\n    ScryptedInterfaceProperty[\"noxDensity\"] = \"noxDensity\";\n    ScryptedInterfaceProperty[\"co2ppm\"] = \"co2ppm\";\n    ScryptedInterfaceProperty[\"airQuality\"] = \"airQuality\";\n    ScryptedInterfaceProperty[\"airPurifierState\"] = \"airPurifierState\";\n    ScryptedInterfaceProperty[\"filterChangeIndication\"] = \"filterChangeIndication\";\n    ScryptedInterfaceProperty[\"filterLifeLevel\"] = \"filterLifeLevel\";\n    ScryptedInterfaceProperty[\"humiditySetting\"] = \"humiditySetting\";\n    ScryptedInterfaceProperty[\"fan\"] = \"fan\";\n    ScryptedInterfaceProperty[\"applicationInfo\"] = \"applicationInfo\";\n    ScryptedInterfaceProperty[\"systemDevice\"] = \"systemDevice\";\n})(ScryptedInterfaceProperty || (exports.ScryptedInterfaceProperty = ScryptedInterfaceProperty = {}));\nvar ScryptedInterfaceMethod;\n(function (ScryptedInterfaceMethod) {\n    ScryptedInterfaceMethod[\"listen\"] = \"listen\";\n    ScryptedInterfaceMethod[\"probe\"] = \"probe\";\n    ScryptedInterfaceMethod[\"setMixins\"] = \"setMixins\";\n    ScryptedInterfaceMethod[\"setName\"] = \"setName\";\n    ScryptedInterfaceMethod[\"setRoom\"] = \"setRoom\";\n    ScryptedInterfaceMethod[\"setType\"] = \"setType\";\n    ScryptedInterfaceMethod[\"getPluginJson\"] = \"getPluginJson\";\n    ScryptedInterfaceMethod[\"turnOff\"] = \"turnOff\";\n    ScryptedInterfaceMethod[\"turnOn\"] = \"turnOn\";\n    ScryptedInterfaceMethod[\"setBrightness\"] = \"setBrightness\";\n    ScryptedInterfaceMethod[\"getTemperatureMaxK\"] = \"getTemperatureMaxK\";\n    ScryptedInterfaceMethod[\"getTemperatureMinK\"] = \"getTemperatureMinK\";\n    ScryptedInterfaceMethod[\"setColorTemperature\"] = \"setColorTemperature\";\n    ScryptedInterfaceMethod[\"setRgb\"] = \"setRgb\";\n    ScryptedInterfaceMethod[\"setHsv\"] = \"setHsv\";\n    ScryptedInterfaceMethod[\"pressButton\"] = \"pressButton\";\n    ScryptedInterfaceMethod[\"sendNotification\"] = \"sendNotification\";\n    ScryptedInterfaceMethod[\"start\"] = \"start\";\n    ScryptedInterfaceMethod[\"stop\"] = \"stop\";\n    ScryptedInterfaceMethod[\"pause\"] = \"pause\";\n    ScryptedInterfaceMethod[\"resume\"] = \"resume\";\n    ScryptedInterfaceMethod[\"dock\"] = \"dock\";\n    ScryptedInterfaceMethod[\"setTemperature\"] = \"setTemperature\";\n    ScryptedInterfaceMethod[\"setTemperatureUnit\"] = \"setTemperatureUnit\";\n    ScryptedInterfaceMethod[\"getPictureOptions\"] = \"getPictureOptions\";\n    ScryptedInterfaceMethod[\"takePicture\"] = \"takePicture\";\n    ScryptedInterfaceMethod[\"getAudioStream\"] = \"getAudioStream\";\n    ScryptedInterfaceMethod[\"setAudioVolumes\"] = \"setAudioVolumes\";\n    ScryptedInterfaceMethod[\"startDisplay\"] = \"startDisplay\";\n    ScryptedInterfaceMethod[\"stopDisplay\"] = \"stopDisplay\";\n    ScryptedInterfaceMethod[\"getVideoStream\"] = \"getVideoStream\";\n    ScryptedInterfaceMethod[\"getVideoStreamOptions\"] = \"getVideoStreamOptions\";\n    ScryptedInterfaceMethod[\"getPrivacyMasks\"] = \"getPrivacyMasks\";\n    ScryptedInterfaceMethod[\"setPrivacyMasks\"] = \"setPrivacyMasks\";\n    ScryptedInterfaceMethod[\"getVideoTextOverlays\"] = \"getVideoTextOverlays\";\n    ScryptedInterfaceMethod[\"setVideoTextOverlay\"] = \"setVideoTextOverlay\";\n    ScryptedInterfaceMethod[\"getRecordingStream\"] = \"getRecordingStream\";\n    ScryptedInterfaceMethod[\"getRecordingStreamCurrentTime\"] = \"getRecordingStreamCurrentTime\";\n    ScryptedInterfaceMethod[\"getRecordingStreamOptions\"] = \"getRecordingStreamOptions\";\n    ScryptedInterfaceMethod[\"getRecordingStreamThumbnail\"] = \"getRecordingStreamThumbnail\";\n    ScryptedInterfaceMethod[\"deleteRecordingStream\"] = \"deleteRecordingStream\";\n    ScryptedInterfaceMethod[\"setRecordingActive\"] = \"setRecordingActive\";\n    ScryptedInterfaceMethod[\"ptzCommand\"] = \"ptzCommand\";\n    ScryptedInterfaceMethod[\"getRecordedEvents\"] = \"getRecordedEvents\";\n    ScryptedInterfaceMethod[\"getVideoClip\"] = \"getVideoClip\";\n    ScryptedInterfaceMethod[\"getVideoClips\"] = \"getVideoClips\";\n    ScryptedInterfaceMethod[\"getVideoClipThumbnail\"] = \"getVideoClipThumbnail\";\n    ScryptedInterfaceMethod[\"removeVideoClips\"] = \"removeVideoClips\";\n    ScryptedInterfaceMethod[\"setVideoStreamOptions\"] = \"setVideoStreamOptions\";\n    ScryptedInterfaceMethod[\"startIntercom\"] = \"startIntercom\";\n    ScryptedInterfaceMethod[\"stopIntercom\"] = \"stopIntercom\";\n    ScryptedInterfaceMethod[\"lock\"] = \"lock\";\n    ScryptedInterfaceMethod[\"unlock\"] = \"unlock\";\n    ScryptedInterfaceMethod[\"addPassword\"] = \"addPassword\";\n    ScryptedInterfaceMethod[\"getPasswords\"] = \"getPasswords\";\n    ScryptedInterfaceMethod[\"removePassword\"] = \"removePassword\";\n    ScryptedInterfaceMethod[\"activate\"] = \"activate\";\n    ScryptedInterfaceMethod[\"deactivate\"] = \"deactivate\";\n    ScryptedInterfaceMethod[\"isReversible\"] = \"isReversible\";\n    ScryptedInterfaceMethod[\"closeEntry\"] = \"closeEntry\";\n    ScryptedInterfaceMethod[\"openEntry\"] = \"openEntry\";\n    ScryptedInterfaceMethod[\"getDevice\"] = \"getDevice\";\n    ScryptedInterfaceMethod[\"releaseDevice\"] = \"releaseDevice\";\n    ScryptedInterfaceMethod[\"adoptDevice\"] = \"adoptDevice\";\n    ScryptedInterfaceMethod[\"discoverDevices\"] = \"discoverDevices\";\n    ScryptedInterfaceMethod[\"createDevice\"] = \"createDevice\";\n    ScryptedInterfaceMethod[\"getCreateDeviceSettings\"] = \"getCreateDeviceSettings\";\n    ScryptedInterfaceMethod[\"reboot\"] = \"reboot\";\n    ScryptedInterfaceMethod[\"getRefreshFrequency\"] = \"getRefreshFrequency\";\n    ScryptedInterfaceMethod[\"refresh\"] = \"refresh\";\n    ScryptedInterfaceMethod[\"getMediaStatus\"] = \"getMediaStatus\";\n    ScryptedInterfaceMethod[\"load\"] = \"load\";\n    ScryptedInterfaceMethod[\"seek\"] = \"seek\";\n    ScryptedInterfaceMethod[\"skipNext\"] = \"skipNext\";\n    ScryptedInterfaceMethod[\"skipPrevious\"] = \"skipPrevious\";\n    ScryptedInterfaceMethod[\"convert\"] = \"convert\";\n    ScryptedInterfaceMethod[\"convertMedia\"] = \"convertMedia\";\n    ScryptedInterfaceMethod[\"getSettings\"] = \"getSettings\";\n    ScryptedInterfaceMethod[\"putSetting\"] = \"putSetting\";\n    ScryptedInterfaceMethod[\"armSecuritySystem\"] = \"armSecuritySystem\";\n    ScryptedInterfaceMethod[\"disarmSecuritySystem\"] = \"disarmSecuritySystem\";\n    ScryptedInterfaceMethod[\"setAirPurifierState\"] = \"setAirPurifierState\";\n    ScryptedInterfaceMethod[\"getReadmeMarkdown\"] = \"getReadmeMarkdown\";\n    ScryptedInterfaceMethod[\"getOauthUrl\"] = \"getOauthUrl\";\n    ScryptedInterfaceMethod[\"onOauthCallback\"] = \"onOauthCallback\";\n    ScryptedInterfaceMethod[\"canMixin\"] = \"canMixin\";\n    ScryptedInterfaceMethod[\"getMixin\"] = \"getMixin\";\n    ScryptedInterfaceMethod[\"releaseMixin\"] = \"releaseMixin\";\n    ScryptedInterfaceMethod[\"onRequest\"] = \"onRequest\";\n    ScryptedInterfaceMethod[\"onConnection\"] = \"onConnection\";\n    ScryptedInterfaceMethod[\"onPush\"] = \"onPush\";\n    ScryptedInterfaceMethod[\"run\"] = \"run\";\n    ScryptedInterfaceMethod[\"eval\"] = \"eval\";\n    ScryptedInterfaceMethod[\"loadScripts\"] = \"loadScripts\";\n    ScryptedInterfaceMethod[\"saveScript\"] = \"saveScript\";\n    ScryptedInterfaceMethod[\"forkInterface\"] = \"forkInterface\";\n    ScryptedInterfaceMethod[\"trackObjects\"] = \"trackObjects\";\n    ScryptedInterfaceMethod[\"getDetectionInput\"] = \"getDetectionInput\";\n    ScryptedInterfaceMethod[\"getObjectTypes\"] = \"getObjectTypes\";\n    ScryptedInterfaceMethod[\"detectObjects\"] = \"detectObjects\";\n    ScryptedInterfaceMethod[\"generateObjectDetections\"] = \"generateObjectDetections\";\n    ScryptedInterfaceMethod[\"getDetectionModel\"] = \"getDetectionModel\";\n    ScryptedInterfaceMethod[\"setHumidity\"] = \"setHumidity\";\n    ScryptedInterfaceMethod[\"setFan\"] = \"setFan\";\n    ScryptedInterfaceMethod[\"startRTCSignalingSession\"] = \"startRTCSignalingSession\";\n    ScryptedInterfaceMethod[\"createRTCSignalingSession\"] = \"createRTCSignalingSession\";\n    ScryptedInterfaceMethod[\"getScryptedUserAccessControl\"] = \"getScryptedUserAccessControl\";\n    ScryptedInterfaceMethod[\"generateVideoFrames\"] = \"generateVideoFrames\";\n    ScryptedInterfaceMethod[\"connectStream\"] = \"connectStream\";\n    ScryptedInterfaceMethod[\"getTTYSettings\"] = \"getTTYSettings\";\n})(ScryptedInterfaceMethod || (exports.ScryptedInterfaceMethod = ScryptedInterfaceMethod = {}));\nexports.ScryptedInterfaceDescriptors = {\n    \"ScryptedDevice\": {\n        \"name\": \"ScryptedDevice\",\n        \"methods\": [\n            \"listen\",\n            \"probe\",\n            \"setMixins\",\n            \"setName\",\n            \"setRoom\",\n            \"setType\"\n        ],\n        \"properties\": [\n            \"id\",\n            \"info\",\n            \"interfaces\",\n            \"mixins\",\n            \"name\",\n            \"nativeId\",\n            \"pluginId\",\n            \"providedInterfaces\",\n            \"providedName\",\n            \"providedRoom\",\n            \"providedType\",\n            \"providerId\",\n            \"room\",\n            \"type\"\n        ]\n    },\n    \"ScryptedPlugin\": {\n        \"name\": \"ScryptedPlugin\",\n        \"methods\": [\n            \"getPluginJson\"\n        ],\n        \"properties\": []\n    },\n    \"ScryptedPluginRuntime\": {\n        \"name\": \"ScryptedPluginRuntime\",\n        \"methods\": [],\n        \"properties\": [\n            \"scryptedRuntimeArguments\"\n        ]\n    },\n    \"OnOff\": {\n        \"name\": \"OnOff\",\n        \"methods\": [\n            \"turnOff\",\n            \"turnOn\"\n        ],\n        \"properties\": [\n            \"on\"\n        ]\n    },\n    \"Brightness\": {\n        \"name\": \"Brightness\",\n        \"methods\": [\n            \"setBrightness\"\n        ],\n        \"properties\": [\n            \"brightness\"\n        ]\n    },\n    \"ColorSettingTemperature\": {\n        \"name\": \"ColorSettingTemperature\",\n        \"methods\": [\n            \"getTemperatureMaxK\",\n            \"getTemperatureMinK\",\n            \"setColorTemperature\"\n        ],\n        \"properties\": [\n            \"colorTemperature\"\n        ]\n    },\n    \"ColorSettingRgb\": {\n        \"name\": \"ColorSettingRgb\",\n        \"methods\": [\n            \"setRgb\"\n        ],\n        \"properties\": [\n            \"rgb\"\n        ]\n    },\n    \"ColorSettingHsv\": {\n        \"name\": \"ColorSettingHsv\",\n        \"methods\": [\n            \"setHsv\"\n        ],\n        \"properties\": [\n            \"hsv\"\n        ]\n    },\n    \"Buttons\": {\n        \"name\": \"Buttons\",\n        \"methods\": [],\n        \"properties\": [\n            \"buttons\"\n        ]\n    },\n    \"PressButtons\": {\n        \"name\": \"PressButtons\",\n        \"methods\": [\n            \"pressButton\"\n        ],\n        \"properties\": []\n    },\n    \"Sensors\": {\n        \"name\": \"Sensors\",\n        \"methods\": [],\n        \"properties\": [\n            \"sensors\"\n        ]\n    },\n    \"Notifier\": {\n        \"name\": \"Notifier\",\n        \"methods\": [\n            \"sendNotification\"\n        ],\n        \"properties\": []\n    },\n    \"StartStop\": {\n        \"name\": \"StartStop\",\n        \"methods\": [\n            \"start\",\n            \"stop\"\n        ],\n        \"properties\": [\n            \"running\"\n        ]\n    },\n    \"Pause\": {\n        \"name\": \"Pause\",\n        \"methods\": [\n            \"pause\",\n            \"resume\"\n        ],\n        \"properties\": [\n            \"paused\"\n        ]\n    },\n    \"Dock\": {\n        \"name\": \"Dock\",\n        \"methods\": [\n            \"dock\"\n        ],\n        \"properties\": [\n            \"docked\"\n        ]\n    },\n    \"TemperatureSetting\": {\n        \"name\": \"TemperatureSetting\",\n        \"methods\": [\n            \"setTemperature\"\n        ],\n        \"properties\": [\n            \"temperatureSetting\"\n        ]\n    },\n    \"Thermometer\": {\n        \"name\": \"Thermometer\",\n        \"methods\": [\n            \"setTemperatureUnit\"\n        ],\n        \"properties\": [\n            \"temperature\",\n            \"temperatureUnit\"\n        ]\n    },\n    \"HumiditySensor\": {\n        \"name\": \"HumiditySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"humidity\"\n        ]\n    },\n    \"Camera\": {\n        \"name\": \"Camera\",\n        \"methods\": [\n            \"getPictureOptions\",\n            \"takePicture\"\n        ],\n        \"properties\": []\n    },\n    \"Microphone\": {\n        \"name\": \"Microphone\",\n        \"methods\": [\n            \"getAudioStream\"\n        ],\n        \"properties\": []\n    },\n    \"AudioVolumeControl\": {\n        \"name\": \"AudioVolumeControl\",\n        \"methods\": [\n            \"setAudioVolumes\"\n        ],\n        \"properties\": [\n            \"audioVolumes\"\n        ]\n    },\n    \"Display\": {\n        \"name\": \"Display\",\n        \"methods\": [\n            \"startDisplay\",\n            \"stopDisplay\"\n        ],\n        \"properties\": []\n    },\n    \"VideoCamera\": {\n        \"name\": \"VideoCamera\",\n        \"methods\": [\n            \"getVideoStream\",\n            \"getVideoStreamOptions\"\n        ],\n        \"properties\": []\n    },\n    \"VideoCameraMask\": {\n        \"name\": \"VideoCameraMask\",\n        \"methods\": [\n            \"getPrivacyMasks\",\n            \"setPrivacyMasks\"\n        ],\n        \"properties\": []\n    },\n    \"VideoTextOverlays\": {\n        \"name\": \"VideoTextOverlays\",\n        \"methods\": [\n            \"getVideoTextOverlays\",\n            \"setVideoTextOverlay\"\n        ],\n        \"properties\": []\n    },\n    \"VideoRecorder\": {\n        \"name\": \"VideoRecorder\",\n        \"methods\": [\n            \"getRecordingStream\",\n            \"getRecordingStreamCurrentTime\",\n            \"getRecordingStreamOptions\",\n            \"getRecordingStreamThumbnail\"\n        ],\n        \"properties\": [\n            \"recordingActive\"\n        ]\n    },\n    \"VideoRecorderManagement\": {\n        \"name\": \"VideoRecorderManagement\",\n        \"methods\": [\n            \"deleteRecordingStream\",\n            \"setRecordingActive\"\n        ],\n        \"properties\": []\n    },\n    \"PanTiltZoom\": {\n        \"name\": \"PanTiltZoom\",\n        \"methods\": [\n            \"ptzCommand\"\n        ],\n        \"properties\": [\n            \"ptzCapabilities\"\n        ]\n    },\n    \"EventRecorder\": {\n        \"name\": \"EventRecorder\",\n        \"methods\": [\n            \"getRecordedEvents\"\n        ],\n        \"properties\": []\n    },\n    \"VideoClips\": {\n        \"name\": \"VideoClips\",\n        \"methods\": [\n            \"getVideoClip\",\n            \"getVideoClips\",\n            \"getVideoClipThumbnail\",\n            \"removeVideoClips\"\n        ],\n        \"properties\": []\n    },\n    \"VideoCameraConfiguration\": {\n        \"name\": \"VideoCameraConfiguration\",\n        \"methods\": [\n            \"setVideoStreamOptions\"\n        ],\n        \"properties\": []\n    },\n    \"Intercom\": {\n        \"name\": \"Intercom\",\n        \"methods\": [\n            \"startIntercom\",\n            \"stopIntercom\"\n        ],\n        \"properties\": []\n    },\n    \"Lock\": {\n        \"name\": \"Lock\",\n        \"methods\": [\n            \"lock\",\n            \"unlock\"\n        ],\n        \"properties\": [\n            \"lockState\"\n        ]\n    },\n    \"PasswordStore\": {\n        \"name\": \"PasswordStore\",\n        \"methods\": [\n            \"addPassword\",\n            \"getPasswords\",\n            \"removePassword\"\n        ],\n        \"properties\": []\n    },\n    \"Scene\": {\n        \"name\": \"Scene\",\n        \"methods\": [\n            \"activate\",\n            \"deactivate\",\n            \"isReversible\"\n        ],\n        \"properties\": []\n    },\n    \"Entry\": {\n        \"name\": \"Entry\",\n        \"methods\": [\n            \"closeEntry\",\n            \"openEntry\"\n        ],\n        \"properties\": []\n    },\n    \"EntrySensor\": {\n        \"name\": \"EntrySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"entryOpen\"\n        ]\n    },\n    \"DeviceProvider\": {\n        \"name\": \"DeviceProvider\",\n        \"methods\": [\n            \"getDevice\",\n            \"releaseDevice\"\n        ],\n        \"properties\": []\n    },\n    \"DeviceDiscovery\": {\n        \"name\": \"DeviceDiscovery\",\n        \"methods\": [\n            \"adoptDevice\",\n            \"discoverDevices\"\n        ],\n        \"properties\": []\n    },\n    \"DeviceCreator\": {\n        \"name\": \"DeviceCreator\",\n        \"methods\": [\n            \"createDevice\",\n            \"getCreateDeviceSettings\"\n        ],\n        \"properties\": []\n    },\n    \"Battery\": {\n        \"name\": \"Battery\",\n        \"methods\": [],\n        \"properties\": [\n            \"batteryLevel\"\n        ]\n    },\n    \"Charger\": {\n        \"name\": \"Charger\",\n        \"methods\": [],\n        \"properties\": [\n            \"chargeState\"\n        ]\n    },\n    \"Reboot\": {\n        \"name\": \"Reboot\",\n        \"methods\": [\n            \"reboot\"\n        ],\n        \"properties\": []\n    },\n    \"Refresh\": {\n        \"name\": \"Refresh\",\n        \"methods\": [\n            \"getRefreshFrequency\",\n            \"refresh\"\n        ],\n        \"properties\": []\n    },\n    \"MediaPlayer\": {\n        \"name\": \"MediaPlayer\",\n        \"methods\": [\n            \"getMediaStatus\",\n            \"load\",\n            \"seek\",\n            \"skipNext\",\n            \"skipPrevious\"\n        ],\n        \"properties\": []\n    },\n    \"Online\": {\n        \"name\": \"Online\",\n        \"methods\": [],\n        \"properties\": [\n            \"online\"\n        ]\n    },\n    \"BufferConverter\": {\n        \"name\": \"BufferConverter\",\n        \"methods\": [\n            \"convert\"\n        ],\n        \"properties\": [\n            \"fromMimeType\",\n            \"toMimeType\"\n        ]\n    },\n    \"MediaConverter\": {\n        \"name\": \"MediaConverter\",\n        \"methods\": [\n            \"convertMedia\"\n        ],\n        \"properties\": [\n            \"converters\"\n        ]\n    },\n    \"Settings\": {\n        \"name\": \"Settings\",\n        \"methods\": [\n            \"getSettings\",\n            \"putSetting\"\n        ],\n        \"properties\": []\n    },\n    \"BinarySensor\": {\n        \"name\": \"BinarySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"binaryState\"\n        ]\n    },\n    \"TamperSensor\": {\n        \"name\": \"TamperSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"tampered\"\n        ]\n    },\n    \"Sleep\": {\n        \"name\": \"Sleep\",\n        \"methods\": [],\n        \"properties\": [\n            \"sleeping\"\n        ]\n    },\n    \"PowerSensor\": {\n        \"name\": \"PowerSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"powerDetected\"\n        ]\n    },\n    \"AudioSensor\": {\n        \"name\": \"AudioSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"audioDetected\"\n        ]\n    },\n    \"MotionSensor\": {\n        \"name\": \"MotionSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"motionDetected\"\n        ]\n    },\n    \"AmbientLightSensor\": {\n        \"name\": \"AmbientLightSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"ambientLight\"\n        ]\n    },\n    \"OccupancySensor\": {\n        \"name\": \"OccupancySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"occupied\"\n        ]\n    },\n    \"FloodSensor\": {\n        \"name\": \"FloodSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"flooded\"\n        ]\n    },\n    \"UltravioletSensor\": {\n        \"name\": \"UltravioletSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"ultraviolet\"\n        ]\n    },\n    \"LuminanceSensor\": {\n        \"name\": \"LuminanceSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"luminance\"\n        ]\n    },\n    \"PositionSensor\": {\n        \"name\": \"PositionSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"position\"\n        ]\n    },\n    \"SecuritySystem\": {\n        \"name\": \"SecuritySystem\",\n        \"methods\": [\n            \"armSecuritySystem\",\n            \"disarmSecuritySystem\"\n        ],\n        \"properties\": [\n            \"securitySystemState\"\n        ]\n    },\n    \"PM10Sensor\": {\n        \"name\": \"PM10Sensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"pm10Density\"\n        ]\n    },\n    \"PM25Sensor\": {\n        \"name\": \"PM25Sensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"pm25Density\"\n        ]\n    },\n    \"VOCSensor\": {\n        \"name\": \"VOCSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"vocDensity\"\n        ]\n    },\n    \"NOXSensor\": {\n        \"name\": \"NOXSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"noxDensity\"\n        ]\n    },\n    \"CO2Sensor\": {\n        \"name\": \"CO2Sensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"co2ppm\"\n        ]\n    },\n    \"AirQualitySensor\": {\n        \"name\": \"AirQualitySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"airQuality\"\n        ]\n    },\n    \"AirPurifier\": {\n        \"name\": \"AirPurifier\",\n        \"methods\": [\n            \"setAirPurifierState\"\n        ],\n        \"properties\": [\n            \"airPurifierState\"\n        ]\n    },\n    \"FilterMaintenance\": {\n        \"name\": \"FilterMaintenance\",\n        \"methods\": [],\n        \"properties\": [\n            \"filterChangeIndication\",\n            \"filterLifeLevel\"\n        ]\n    },\n    \"Readme\": {\n        \"name\": \"Readme\",\n        \"methods\": [\n            \"getReadmeMarkdown\"\n        ],\n        \"properties\": []\n    },\n    \"OauthClient\": {\n        \"name\": \"OauthClient\",\n        \"methods\": [\n            \"getOauthUrl\",\n            \"onOauthCallback\"\n        ],\n        \"properties\": []\n    },\n    \"MixinProvider\": {\n        \"name\": \"MixinProvider\",\n        \"methods\": [\n            \"canMixin\",\n            \"getMixin\",\n            \"releaseMixin\"\n        ],\n        \"properties\": []\n    },\n    \"HttpRequestHandler\": {\n        \"name\": \"HttpRequestHandler\",\n        \"methods\": [\n            \"onRequest\"\n        ],\n        \"properties\": []\n    },\n    \"EngineIOHandler\": {\n        \"name\": \"EngineIOHandler\",\n        \"methods\": [\n            \"onConnection\"\n        ],\n        \"properties\": []\n    },\n    \"PushHandler\": {\n        \"name\": \"PushHandler\",\n        \"methods\": [\n            \"onPush\"\n        ],\n        \"properties\": []\n    },\n    \"Program\": {\n        \"name\": \"Program\",\n        \"methods\": [\n            \"run\"\n        ],\n        \"properties\": []\n    },\n    \"Scriptable\": {\n        \"name\": \"Scriptable\",\n        \"methods\": [\n            \"eval\",\n            \"loadScripts\",\n            \"saveScript\"\n        ],\n        \"properties\": []\n    },\n    \"ClusterForkInterface\": {\n        \"name\": \"ClusterForkInterface\",\n        \"methods\": [\n            \"forkInterface\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectTracker\": {\n        \"name\": \"ObjectTracker\",\n        \"methods\": [\n            \"trackObjects\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectDetector\": {\n        \"name\": \"ObjectDetector\",\n        \"methods\": [\n            \"getDetectionInput\",\n            \"getObjectTypes\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectDetection\": {\n        \"name\": \"ObjectDetection\",\n        \"methods\": [\n            \"detectObjects\",\n            \"generateObjectDetections\",\n            \"getDetectionModel\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectDetectionPreview\": {\n        \"name\": \"ObjectDetectionPreview\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"ObjectDetectionGenerator\": {\n        \"name\": \"ObjectDetectionGenerator\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"HumiditySetting\": {\n        \"name\": \"HumiditySetting\",\n        \"methods\": [\n            \"setHumidity\"\n        ],\n        \"properties\": [\n            \"humiditySetting\"\n        ]\n    },\n    \"Fan\": {\n        \"name\": \"Fan\",\n        \"methods\": [\n            \"setFan\"\n        ],\n        \"properties\": [\n            \"fan\"\n        ]\n    },\n    \"RTCSignalingChannel\": {\n        \"name\": \"RTCSignalingChannel\",\n        \"methods\": [\n            \"startRTCSignalingSession\"\n        ],\n        \"properties\": []\n    },\n    \"RTCSignalingClient\": {\n        \"name\": \"RTCSignalingClient\",\n        \"methods\": [\n            \"createRTCSignalingSession\"\n        ],\n        \"properties\": []\n    },\n    \"LauncherApplication\": {\n        \"name\": \"LauncherApplication\",\n        \"methods\": [],\n        \"properties\": [\n            \"applicationInfo\"\n        ]\n    },\n    \"ScryptedUser\": {\n        \"name\": \"ScryptedUser\",\n        \"methods\": [\n            \"getScryptedUserAccessControl\"\n        ],\n        \"properties\": []\n    },\n    \"VideoFrameGenerator\": {\n        \"name\": \"VideoFrameGenerator\",\n        \"methods\": [\n            \"generateVideoFrames\"\n        ],\n        \"properties\": []\n    },\n    \"StreamService\": {\n        \"name\": \"StreamService\",\n        \"methods\": [\n            \"connectStream\"\n        ],\n        \"properties\": []\n    },\n    \"TTY\": {\n        \"name\": \"TTY\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"TTYSettings\": {\n        \"name\": \"TTYSettings\",\n        \"methods\": [\n            \"getTTYSettings\"\n        ],\n        \"properties\": []\n    },\n    \"ScryptedSystemDevice\": {\n        \"name\": \"ScryptedSystemDevice\",\n        \"methods\": [],\n        \"properties\": [\n            \"systemDevice\"\n        ]\n    },\n    \"ScryptedDeviceCreator\": {\n        \"name\": \"ScryptedDeviceCreator\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"ScryptedSettings\": {\n        \"name\": \"ScryptedSettings\",\n        \"methods\": [],\n        \"properties\": []\n    }\n};\n/**\n * @category Core Reference\n */\nvar ScryptedDeviceType;\n(function (ScryptedDeviceType) {\n    ScryptedDeviceType[\"Builtin\"] = \"Builtin\";\n    ScryptedDeviceType[\"Camera\"] = \"Camera\";\n    ScryptedDeviceType[\"Fan\"] = \"Fan\";\n    ScryptedDeviceType[\"Light\"] = \"Light\";\n    ScryptedDeviceType[\"Switch\"] = \"Switch\";\n    ScryptedDeviceType[\"Outlet\"] = \"Outlet\";\n    ScryptedDeviceType[\"Sensor\"] = \"Sensor\";\n    ScryptedDeviceType[\"Scene\"] = \"Scene\";\n    ScryptedDeviceType[\"Program\"] = \"Program\";\n    ScryptedDeviceType[\"Automation\"] = \"Automation\";\n    ScryptedDeviceType[\"Vacuum\"] = \"Vacuum\";\n    ScryptedDeviceType[\"Notifier\"] = \"Notifier\";\n    ScryptedDeviceType[\"Thermostat\"] = \"Thermostat\";\n    ScryptedDeviceType[\"Lock\"] = \"Lock\";\n    ScryptedDeviceType[\"PasswordControl\"] = \"PasswordControl\";\n    /**\n     * Displays have audio and video output.\n     */\n    ScryptedDeviceType[\"Display\"] = \"Display\";\n    /**\n     * Smart Displays have two way audio and video.\n     */\n    ScryptedDeviceType[\"SmartDisplay\"] = \"SmartDisplay\";\n    ScryptedDeviceType[\"Speaker\"] = \"Speaker\";\n    /**\n     * Smart Speakers have two way audio.\n     */\n    ScryptedDeviceType[\"SmartSpeaker\"] = \"SmartSpeaker\";\n    ScryptedDeviceType[\"Event\"] = \"Event\";\n    ScryptedDeviceType[\"Entry\"] = \"Entry\";\n    ScryptedDeviceType[\"Garage\"] = \"Garage\";\n    ScryptedDeviceType[\"DeviceProvider\"] = \"DeviceProvider\";\n    ScryptedDeviceType[\"DataSource\"] = \"DataSource\";\n    ScryptedDeviceType[\"API\"] = \"API\";\n    ScryptedDeviceType[\"Doorbell\"] = \"Doorbell\";\n    ScryptedDeviceType[\"Irrigation\"] = \"Irrigation\";\n    ScryptedDeviceType[\"Valve\"] = \"Valve\";\n    ScryptedDeviceType[\"Person\"] = \"Person\";\n    ScryptedDeviceType[\"SecuritySystem\"] = \"SecuritySystem\";\n    ScryptedDeviceType[\"WindowCovering\"] = \"WindowCovering\";\n    ScryptedDeviceType[\"Siren\"] = \"Siren\";\n    ScryptedDeviceType[\"AirPurifier\"] = \"AirPurifier\";\n    ScryptedDeviceType[\"Unknown\"] = \"Unknown\";\n})(ScryptedDeviceType || (exports.ScryptedDeviceType = ScryptedDeviceType = {}));\nvar HumidityMode;\n(function (HumidityMode) {\n    HumidityMode[\"Humidify\"] = \"Humidify\";\n    HumidityMode[\"Dehumidify\"] = \"Dehumidify\";\n    HumidityMode[\"Auto\"] = \"Auto\";\n    HumidityMode[\"Off\"] = \"Off\";\n})(HumidityMode || (exports.HumidityMode = HumidityMode = {}));\nvar FanMode;\n(function (FanMode) {\n    FanMode[\"Auto\"] = \"Auto\";\n    FanMode[\"Manual\"] = \"Manual\";\n})(FanMode || (exports.FanMode = FanMode = {}));\nvar TemperatureUnit;\n(function (TemperatureUnit) {\n    TemperatureUnit[\"C\"] = \"C\";\n    TemperatureUnit[\"F\"] = \"F\";\n})(TemperatureUnit || (exports.TemperatureUnit = TemperatureUnit = {}));\nvar ThermostatMode;\n(function (ThermostatMode) {\n    ThermostatMode[\"Off\"] = \"Off\";\n    ThermostatMode[\"Cool\"] = \"Cool\";\n    ThermostatMode[\"Heat\"] = \"Heat\";\n    ThermostatMode[\"HeatCool\"] = \"HeatCool\";\n    ThermostatMode[\"Auto\"] = \"Auto\";\n    ThermostatMode[\"FanOnly\"] = \"FanOnly\";\n    ThermostatMode[\"Purifier\"] = \"Purifier\";\n    ThermostatMode[\"Eco\"] = \"Eco\";\n    ThermostatMode[\"Dry\"] = \"Dry\";\n    ThermostatMode[\"On\"] = \"On\";\n})(ThermostatMode || (exports.ThermostatMode = ThermostatMode = {}));\nvar PanTiltZoomMovement;\n(function (PanTiltZoomMovement) {\n    PanTiltZoomMovement[\"Absolute\"] = \"Absolute\";\n    PanTiltZoomMovement[\"Relative\"] = \"Relative\";\n    PanTiltZoomMovement[\"Continuous\"] = \"Continuous\";\n    PanTiltZoomMovement[\"Preset\"] = \"Preset\";\n    PanTiltZoomMovement[\"Home\"] = \"Home\";\n})(PanTiltZoomMovement || (exports.PanTiltZoomMovement = PanTiltZoomMovement = {}));\nvar LockState;\n(function (LockState) {\n    LockState[\"Locked\"] = \"Locked\";\n    LockState[\"Unlocked\"] = \"Unlocked\";\n    LockState[\"Jammed\"] = \"Jammed\";\n})(LockState || (exports.LockState = LockState = {}));\nvar ChargeState;\n(function (ChargeState) {\n    ChargeState[\"Trickle\"] = \"trickle\";\n    ChargeState[\"Charging\"] = \"charging\";\n    ChargeState[\"NotCharging\"] = \"not-charging\";\n})(ChargeState || (exports.ChargeState = ChargeState = {}));\nvar AirPurifierStatus;\n(function (AirPurifierStatus) {\n    AirPurifierStatus[\"Inactive\"] = \"Inactive\";\n    AirPurifierStatus[\"Idle\"] = \"Idle\";\n    AirPurifierStatus[\"Active\"] = \"Active\";\n    AirPurifierStatus[\"ActiveNightMode\"] = \"ActiveNightMode\";\n})(AirPurifierStatus || (exports.AirPurifierStatus = AirPurifierStatus = {}));\nvar AirPurifierMode;\n(function (AirPurifierMode) {\n    AirPurifierMode[\"Manual\"] = \"Manual\";\n    AirPurifierMode[\"Automatic\"] = \"Automatic\";\n})(AirPurifierMode || (exports.AirPurifierMode = AirPurifierMode = {}));\nvar AirQuality;\n(function (AirQuality) {\n    AirQuality[\"Unknown\"] = \"Unknown\";\n    AirQuality[\"Excellent\"] = \"Excellent\";\n    AirQuality[\"Good\"] = \"Good\";\n    AirQuality[\"Fair\"] = \"Fair\";\n    AirQuality[\"Inferior\"] = \"Inferior\";\n    AirQuality[\"Poor\"] = \"Poor\";\n})(AirQuality || (exports.AirQuality = AirQuality = {}));\nvar SecuritySystemMode;\n(function (SecuritySystemMode) {\n    SecuritySystemMode[\"Disarmed\"] = \"Disarmed\";\n    SecuritySystemMode[\"HomeArmed\"] = \"HomeArmed\";\n    SecuritySystemMode[\"AwayArmed\"] = \"AwayArmed\";\n    SecuritySystemMode[\"NightArmed\"] = \"NightArmed\";\n})(SecuritySystemMode || (exports.SecuritySystemMode = SecuritySystemMode = {}));\nvar SecuritySystemObstruction;\n(function (SecuritySystemObstruction) {\n    SecuritySystemObstruction[\"Sensor\"] = \"Sensor\";\n    SecuritySystemObstruction[\"Occupied\"] = \"Occupied\";\n    SecuritySystemObstruction[\"Time\"] = \"Time\";\n    SecuritySystemObstruction[\"Error\"] = \"Error\";\n})(SecuritySystemObstruction || (exports.SecuritySystemObstruction = SecuritySystemObstruction = {}));\nvar MediaPlayerState;\n(function (MediaPlayerState) {\n    MediaPlayerState[\"Idle\"] = \"Idle\";\n    MediaPlayerState[\"Playing\"] = \"Playing\";\n    MediaPlayerState[\"Paused\"] = \"Paused\";\n    MediaPlayerState[\"Buffering\"] = \"Buffering\";\n})(MediaPlayerState || (exports.MediaPlayerState = MediaPlayerState = {}));\nvar ScryptedInterface;\n(function (ScryptedInterface) {\n    ScryptedInterface[\"ScryptedDevice\"] = \"ScryptedDevice\";\n    ScryptedInterface[\"ScryptedPlugin\"] = \"ScryptedPlugin\";\n    ScryptedInterface[\"ScryptedPluginRuntime\"] = \"ScryptedPluginRuntime\";\n    ScryptedInterface[\"OnOff\"] = \"OnOff\";\n    ScryptedInterface[\"Brightness\"] = \"Brightness\";\n    ScryptedInterface[\"ColorSettingTemperature\"] = \"ColorSettingTemperature\";\n    ScryptedInterface[\"ColorSettingRgb\"] = \"ColorSettingRgb\";\n    ScryptedInterface[\"ColorSettingHsv\"] = \"ColorSettingHsv\";\n    ScryptedInterface[\"Buttons\"] = \"Buttons\";\n    ScryptedInterface[\"PressButtons\"] = \"PressButtons\";\n    ScryptedInterface[\"Sensors\"] = \"Sensors\";\n    ScryptedInterface[\"Notifier\"] = \"Notifier\";\n    ScryptedInterface[\"StartStop\"] = \"StartStop\";\n    ScryptedInterface[\"Pause\"] = \"Pause\";\n    ScryptedInterface[\"Dock\"] = \"Dock\";\n    ScryptedInterface[\"TemperatureSetting\"] = \"TemperatureSetting\";\n    ScryptedInterface[\"Thermometer\"] = \"Thermometer\";\n    ScryptedInterface[\"HumiditySensor\"] = \"HumiditySensor\";\n    ScryptedInterface[\"Camera\"] = \"Camera\";\n    ScryptedInterface[\"Microphone\"] = \"Microphone\";\n    ScryptedInterface[\"AudioVolumeControl\"] = \"AudioVolumeControl\";\n    ScryptedInterface[\"Display\"] = \"Display\";\n    ScryptedInterface[\"VideoCamera\"] = \"VideoCamera\";\n    ScryptedInterface[\"VideoCameraMask\"] = \"VideoCameraMask\";\n    ScryptedInterface[\"VideoTextOverlays\"] = \"VideoTextOverlays\";\n    ScryptedInterface[\"VideoRecorder\"] = \"VideoRecorder\";\n    ScryptedInterface[\"VideoRecorderManagement\"] = \"VideoRecorderManagement\";\n    ScryptedInterface[\"PanTiltZoom\"] = \"PanTiltZoom\";\n    ScryptedInterface[\"EventRecorder\"] = \"EventRecorder\";\n    ScryptedInterface[\"VideoClips\"] = \"VideoClips\";\n    ScryptedInterface[\"VideoCameraConfiguration\"] = \"VideoCameraConfiguration\";\n    ScryptedInterface[\"Intercom\"] = \"Intercom\";\n    ScryptedInterface[\"Lock\"] = \"Lock\";\n    ScryptedInterface[\"PasswordStore\"] = \"PasswordStore\";\n    ScryptedInterface[\"Scene\"] = \"Scene\";\n    ScryptedInterface[\"Entry\"] = \"Entry\";\n    ScryptedInterface[\"EntrySensor\"] = \"EntrySensor\";\n    ScryptedInterface[\"DeviceProvider\"] = \"DeviceProvider\";\n    ScryptedInterface[\"DeviceDiscovery\"] = \"DeviceDiscovery\";\n    ScryptedInterface[\"DeviceCreator\"] = \"DeviceCreator\";\n    ScryptedInterface[\"Battery\"] = \"Battery\";\n    ScryptedInterface[\"Charger\"] = \"Charger\";\n    ScryptedInterface[\"Reboot\"] = \"Reboot\";\n    ScryptedInterface[\"Refresh\"] = \"Refresh\";\n    ScryptedInterface[\"MediaPlayer\"] = \"MediaPlayer\";\n    ScryptedInterface[\"Online\"] = \"Online\";\n    ScryptedInterface[\"BufferConverter\"] = \"BufferConverter\";\n    ScryptedInterface[\"MediaConverter\"] = \"MediaConverter\";\n    ScryptedInterface[\"Settings\"] = \"Settings\";\n    ScryptedInterface[\"BinarySensor\"] = \"BinarySensor\";\n    ScryptedInterface[\"TamperSensor\"] = \"TamperSensor\";\n    ScryptedInterface[\"Sleep\"] = \"Sleep\";\n    ScryptedInterface[\"PowerSensor\"] = \"PowerSensor\";\n    ScryptedInterface[\"AudioSensor\"] = \"AudioSensor\";\n    ScryptedInterface[\"MotionSensor\"] = \"MotionSensor\";\n    ScryptedInterface[\"AmbientLightSensor\"] = \"AmbientLightSensor\";\n    ScryptedInterface[\"OccupancySensor\"] = \"OccupancySensor\";\n    ScryptedInterface[\"FloodSensor\"] = \"FloodSensor\";\n    ScryptedInterface[\"UltravioletSensor\"] = \"UltravioletSensor\";\n    ScryptedInterface[\"LuminanceSensor\"] = \"LuminanceSensor\";\n    ScryptedInterface[\"PositionSensor\"] = \"PositionSensor\";\n    ScryptedInterface[\"SecuritySystem\"] = \"SecuritySystem\";\n    ScryptedInterface[\"PM10Sensor\"] = \"PM10Sensor\";\n    ScryptedInterface[\"PM25Sensor\"] = \"PM25Sensor\";\n    ScryptedInterface[\"VOCSensor\"] = \"VOCSensor\";\n    ScryptedInterface[\"NOXSensor\"] = \"NOXSensor\";\n    ScryptedInterface[\"CO2Sensor\"] = \"CO2Sensor\";\n    ScryptedInterface[\"AirQualitySensor\"] = \"AirQualitySensor\";\n    ScryptedInterface[\"AirPurifier\"] = \"AirPurifier\";\n    ScryptedInterface[\"FilterMaintenance\"] = \"FilterMaintenance\";\n    ScryptedInterface[\"Readme\"] = \"Readme\";\n    ScryptedInterface[\"OauthClient\"] = \"OauthClient\";\n    ScryptedInterface[\"MixinProvider\"] = \"MixinProvider\";\n    ScryptedInterface[\"HttpRequestHandler\"] = \"HttpRequestHandler\";\n    ScryptedInterface[\"EngineIOHandler\"] = \"EngineIOHandler\";\n    ScryptedInterface[\"PushHandler\"] = \"PushHandler\";\n    ScryptedInterface[\"Program\"] = \"Program\";\n    ScryptedInterface[\"Scriptable\"] = \"Scriptable\";\n    ScryptedInterface[\"ClusterForkInterface\"] = \"ClusterForkInterface\";\n    ScryptedInterface[\"ObjectTracker\"] = \"ObjectTracker\";\n    ScryptedInterface[\"ObjectDetector\"] = \"ObjectDetector\";\n    ScryptedInterface[\"ObjectDetection\"] = \"ObjectDetection\";\n    ScryptedInterface[\"ObjectDetectionPreview\"] = \"ObjectDetectionPreview\";\n    ScryptedInterface[\"ObjectDetectionGenerator\"] = \"ObjectDetectionGenerator\";\n    ScryptedInterface[\"HumiditySetting\"] = \"HumiditySetting\";\n    ScryptedInterface[\"Fan\"] = \"Fan\";\n    ScryptedInterface[\"RTCSignalingChannel\"] = \"RTCSignalingChannel\";\n    ScryptedInterface[\"RTCSignalingClient\"] = \"RTCSignalingClient\";\n    ScryptedInterface[\"LauncherApplication\"] = \"LauncherApplication\";\n    ScryptedInterface[\"ScryptedUser\"] = \"ScryptedUser\";\n    ScryptedInterface[\"VideoFrameGenerator\"] = \"VideoFrameGenerator\";\n    ScryptedInterface[\"StreamService\"] = \"StreamService\";\n    ScryptedInterface[\"TTY\"] = \"TTY\";\n    ScryptedInterface[\"TTYSettings\"] = \"TTYSettings\";\n    ScryptedInterface[\"ScryptedSystemDevice\"] = \"ScryptedSystemDevice\";\n    ScryptedInterface[\"ScryptedDeviceCreator\"] = \"ScryptedDeviceCreator\";\n    ScryptedInterface[\"ScryptedSettings\"] = \"ScryptedSettings\";\n})(ScryptedInterface || (exports.ScryptedInterface = ScryptedInterface = {}));\nvar ScryptedMimeTypes;\n(function (ScryptedMimeTypes) {\n    ScryptedMimeTypes[\"Url\"] = \"text/x-uri\";\n    ScryptedMimeTypes[\"InsecureLocalUrl\"] = \"text/x-insecure-local-uri\";\n    ScryptedMimeTypes[\"LocalUrl\"] = \"text/x-local-uri\";\n    ScryptedMimeTypes[\"ServerId\"] = \"text/x-server-id\";\n    ScryptedMimeTypes[\"PushEndpoint\"] = \"text/x-push-endpoint\";\n    ScryptedMimeTypes[\"SchemePrefix\"] = \"x-scrypted/x-scrypted-scheme-\";\n    ScryptedMimeTypes[\"MediaStreamUrl\"] = \"text/x-media-url\";\n    ScryptedMimeTypes[\"MediaObject\"] = \"x-scrypted/x-scrypted-media-object\";\n    ScryptedMimeTypes[\"RequestMediaObject\"] = \"x-scrypted/x-scrypted-request-media-object\";\n    ScryptedMimeTypes[\"RequestMediaStream\"] = \"x-scrypted/x-scrypted-request-stream\";\n    ScryptedMimeTypes[\"MediaStreamFeedback\"] = \"x-scrypted/x-media-stream-feedback\";\n    ScryptedMimeTypes[\"FFmpegInput\"] = \"x-scrypted/x-ffmpeg-input\";\n    ScryptedMimeTypes[\"FFmpegTranscodeStream\"] = \"x-scrypted/x-ffmpeg-transcode-stream\";\n    ScryptedMimeTypes[\"RTCSignalingChannel\"] = \"x-scrypted/x-scrypted-rtc-signaling-channel\";\n    ScryptedMimeTypes[\"RTCSignalingSession\"] = \"x-scrypted/x-scrypted-rtc-signaling-session\";\n    ScryptedMimeTypes[\"RTCConnectionManagement\"] = \"x-scrypted/x-scrypted-rtc-connection-management\";\n    ScryptedMimeTypes[\"Image\"] = \"x-scrypted/x-scrypted-image\";\n})(ScryptedMimeTypes || (exports.ScryptedMimeTypes = ScryptedMimeTypes = {}));\n//# sourceMappingURL=index.js.map","import { TemperatureUnit } from \"@scrypted/sdk\";\n\nexport enum UnitGroup {\n    None = 'None',\n    Temperature = 'Temperature',\n    Speed = 'Speed',\n    Length = 'Length',\n    Pressure = 'Pressure',\n}\n\nexport enum Unit {\n    NONE = '',\n    // Temperature\n    // Actually Kelving is SI for temperature\n    C = 'C',\n    F = 'F',\n\n    // Speed\n    M_S = 'm/s',\n    KM_H = 'km/h',\n    MI_H = 'mph',\n\n    // Length\n    M = 'm',\n    MM = 'mm',\n    KM = 'km',\n    IN = 'in',\n    MI = 'mi',\n\n    // Pressure\n    PA = 'Pa',\n    HPA = 'hPa',\n    BAR = 'bar'\n}\n\nconst siUnitMap: Record<UnitGroup, Unit> = {\n    [UnitGroup.None]: Unit.NONE,\n    [UnitGroup.Length]: Unit.M,\n    [UnitGroup.Pressure]: Unit.PA,\n    [UnitGroup.Temperature]: Unit.C,\n    [UnitGroup.Speed]: Unit.M_S,\n}\n\ninterface UnitData {\n    unit: Unit;\n    unitGroup: UnitGroup;\n    factor?: number;\n    conversionFormula?: string;\n}\n\nexport class UnitConverter {\n    static UNITS_MAP: Record<Unit, UnitData> = {\n        [Unit.NONE]: {\n            unit: Unit.NONE,\n            unitGroup: UnitGroup.Temperature,\n            factor: 1,\n        },\n        [Unit.C]: {\n            unit: Unit.C,\n            unitGroup: UnitGroup.Temperature,\n            factor: 1,\n        },\n        [Unit.F]: {\n            unit: Unit.F,\n            unitGroup: UnitGroup.Temperature,\n            conversionFormula: '{fromSi} ? ({value} * 1.8 + 32) : (({value} - 32) / 1.8)',\n        },\n        [Unit.M_S]: {\n            unit: Unit.M_S,\n            unitGroup: UnitGroup.Speed,\n            factor: 1,\n        },\n        [Unit.KM_H]: {\n            unit: Unit.KM_H,\n            unitGroup: UnitGroup.Speed,\n            factor: 0.277777777777778,\n        },\n        [Unit.MI_H]: {\n            unit: Unit.MI_H,\n            unitGroup: UnitGroup.Speed,\n            factor: 0.447038888888889,\n        },\n        [Unit.M]: {\n            unit: Unit.M,\n            unitGroup: UnitGroup.Length,\n            factor: 1,\n        },\n        [Unit.MM]: {\n            unit: Unit.MM,\n            unitGroup: UnitGroup.Length,\n            factor: 0.001,\n        },\n        [Unit.KM]: {\n            unit: Unit.KM,\n            unitGroup: UnitGroup.Length,\n            factor: 1000,\n        },\n        [Unit.IN]: {\n            unit: Unit.IN,\n            unitGroup: UnitGroup.Length,\n            factor: 0.0254,\n        },\n        [Unit.MI]: {\n            unit: Unit.MI,\n            unitGroup: UnitGroup.Length,\n            factor: 1609.34,\n        },\n        [Unit.PA]: {\n            unit: Unit.PA,\n            unitGroup: UnitGroup.Pressure,\n            factor: 1,\n        },\n        [Unit.HPA]: {\n            unit: Unit.HPA,\n            unitGroup: UnitGroup.Pressure,\n            factor: 0.01,\n        },\n        [Unit.BAR]: {\n            unit: Unit.BAR,\n            unitGroup: UnitGroup.Pressure,\n            factor: 0.00001,\n        },\n    }\n\n    static getUnit(\n        unitSrc: UnitData | Unit | string | undefined,\n    ): UnitData {\n        if (!unitSrc) {\n            unitSrc = UnitConverter.UNITS_MAP[Unit.NONE];\n        }\n\n        const unit =\n            typeof unitSrc === 'string' ? unitSrc : unitSrc.unit;\n\n        const unitData = UnitConverter.UNITS_MAP?.[unit];\n        if (!unitData) {\n            return {\n                factor: 1,\n                unit: unit as Unit,\n                unitGroup: UnitGroup.None,\n            };\n        } else {\n            return unitData;\n        }\n    }\n\n    static siToLocal(\n        siValue: number,\n        unit: UnitData | Unit | undefined,\n    ) {\n        if (isNaN(siValue)) {\n            return 0;\n        }\n\n        const unitData = UnitConverter.getUnit(unit);\n\n        if (!unitData) {\n            return siValue;\n        }\n\n        const value = unitData.conversionFormula ?\n            eval(\n                unitData.conversionFormula\n                    .replaceAll('{fromSi}', 'true')\n                    .replaceAll('{value}', String(siValue)),\n            ) :\n            siValue / unitData.factor;\n\n        if (!isNaN(value)) {\n            return value;\n        } else {\n            return 0;\n        }\n    }\n\n    static localToSi(\n        localValue: number,\n        unit: UnitData | Unit | undefined,\n    ) {\n        const unitData = UnitConverter.getUnit(unit);\n\n        if (!unitData) {\n            return localValue;\n        }\n\n        const value = unitData.conversionFormula ?\n            eval(\n                unitData.conversionFormula\n                    .replaceAll('{fromSi}', 'false')\n                    .replaceAll('{value}', String(localValue)),\n            ) :\n            localValue * unitData.factor\n\n        if (!isNaN(value)) {\n            return value;\n        } else {\n            return 0;\n        }\n    }\n\n    static getUnits(\n        unit: Unit | string | undefined,\n    ) {\n        const unitData = UnitConverter.UNITS_MAP[unit];\n\n        if (!unitData) {\n            return [unit];\n        }\n\n        const { unitGroup } = unitData;\n\n        return Object.values(UnitConverter.UNITS_MAP)\n            .filter(unit => unit.unitGroup === unitGroup && unit.unit)\n            ?.map(unit => unit.unit);\n\n    }\n}\n","import sdk, { Battery, ObjectsDetected, ScryptedDeviceBase, ScryptedInterface, Sensors, Setting, Settings, SettingValue, Sleep, TemperatureUnit, VideoTextOverlays } from \"@scrypted/sdk\";\nimport { SettingsMixinDeviceBase, SettingsMixinDeviceOptions } from \"@scrypted/sdk/settings-mixin\";\nimport { StorageSettings, StorageSettingsDict } from \"@scrypted/sdk/storage-settings\";\nimport OsdManagerProvider from \"./main\";\nimport { CameraOverlay, convertSettingsToStorageSettings, formatValue, getOverlay, getOverlayKeys, getOverlaySettings, getTemplateKeys, getEntryText, getLockText, ListenersMap, ListenerType, osdManagerPrefix, Overlay, OverlayType, parseOverlayData, pluginEnabledFilter, getStrippedNativeId } from \"./utils\";\nimport { Unit, UnitConverter } from \"../../scrypted-homeassistant/src/unitConverter\";\n\nexport type CameraType = ScryptedDeviceBase & VideoTextOverlays & Settings & Sleep & Battery;\n\nexport default class OsdManagerMixin extends SettingsMixinDeviceBase<any> implements Settings {\n    initStorage: StorageSettingsDict<string> = {\n        lastFace: {\n            type: 'string',\n            hide: true,\n        },\n        enableDebug: {\n            title: 'Enable debug',\n            type: 'boolean',\n            immediate: true,\n        },\n        duplicateFromDevice: {\n            title: 'Duplicate from device',\n            description: 'Duplicate OSD information from another devices enabled on the plugin',\n            type: 'device',\n            deviceFilter: pluginEnabledFilter,\n            immediate: true,\n            onPut: async (_, value) => await this.duplicateFromDevice(value)\n        },\n        refreshOverlays: {\n            title: 'Get data from camera',\n            type: 'button',\n            onPut: async () => await this.refreshSettings()\n        },\n    };\n    storageSettings = new StorageSettings(this, this.initStorage);\n\n    killed: boolean;\n    overlays: CameraOverlay[] = [];\n    listenersMap: ListenersMap = {};\n    cameraDevice: CameraType;\n    logger: Console;\n\n    constructor(options: SettingsMixinDeviceOptions<any>, private plugin: OsdManagerProvider) {\n        super(options);\n\n        this.plugin.mixinsMap[this.id] = this;\n        this.cameraDevice = sdk.systemManager.getDeviceById<CameraType>(this.id);\n        setTimeout(async () => !this.killed && await this.init(), 2000);\n    }\n\n    removeListeners() {\n        const logger = this.getLogger();\n        try {\n            Object.values(this.listenersMap).forEach(({ listener, interval }) => {\n                listener && listener.removeListener();\n                interval && clearInterval(interval);\n            });\n        } catch (e) {\n            logger.error('Error in removeListeners', e);\n        }\n    }\n\n    async release() {\n        this.killed = true;\n        this.removeListeners();\n    }\n\n    public getLogger() {\n        const deviceConsole = this.console;\n\n        if (!this.logger) {\n            const log = (debug: boolean, message?: any, ...optionalParams: any[]) => {\n                const now = new Date().toLocaleString();\n                if (!debug || this.storageSettings.values.enableDebug) {\n                    deviceConsole.log(` ${now} - `, message, ...optionalParams);\n                }\n            };\n            this.logger = {\n                log: (message?: any, ...optionalParams: any[]) => log(false, message, ...optionalParams),\n                error: (message?: any, ...optionalParams: any[]) => log(false, message, ...optionalParams),\n                debug: (message?: any, ...optionalParams: any[]) => log(true, message, ...optionalParams),\n            } as Console\n        }\n\n        return this.logger;\n    }\n\n    async refreshSettings() {\n        const logger = this.getLogger();\n        logger.log('Refreshing settings');\n        await this.getOverlayData();\n\n        const dynamicSettings = getOverlaySettings({\n            storage: this.storageSettings,\n            overlays: this.overlays,\n            logger,\n            device: this.cameraDevice,\n            templates: this.plugin.storageSettings.values.templates,\n            onSettingUpdated: this.refreshSettings\n        });\n\n        this.storageSettings = await convertSettingsToStorageSettings({\n            device: this,\n            dynamicSettings,\n            initStorage: this.initStorage\n        });\n\n        this.removeListeners();\n        this.start();\n    }\n\n    async getMixinSettings(): Promise<Setting[]> {\n        return this.storageSettings.getSettings();\n    }\n\n    async putSetting(key: string, value: SettingValue): Promise<void> {\n        const [group, ...rest] = key.split(':');\n        if (group === osdManagerPrefix) {\n            this.storageSettings.putSetting(rest.join(':'), value);\n        } else {\n            super.putSetting(key, value);\n        }\n    }\n\n    async putMixinSetting(key: string, value: string) {\n        this.storageSettings.putSetting(key, value);\n    }\n\n    async getOverlayData() {\n        const logger = this.getLogger();\n        try {\n            if (this.cameraDevice.sleeping) {\n                return;\n            }\n\n            const textOverlays = await this.cameraDevice.getVideoTextOverlays();\n            this.overlays = Object.entries(textOverlays)\n                .map(([id, overlay]) => {\n                    return {\n                        id,\n                        ...overlay,\n                    }\n                });\n\n            for (const overlay of this.overlays) {\n                const { currentText } = getOverlay({ overlayId: overlay.id, storageSettings: this.storageSettings });\n                const { currentTextKey } = getOverlayKeys(overlay.id);\n\n                await this.putMixinSetting(currentTextKey, currentText);\n            }\n        } catch (e) {\n            logger.error('Error inr getOverlayData', e);\n        }\n    }\n\n    async duplicateFromDevice(deviceId: string) {\n        const logger = this.getLogger();\n        try {\n            const deviceToDuplicate = sdk.systemManager.getDeviceById<VideoTextOverlays & Settings>(deviceId);\n\n            if (deviceToDuplicate) {\n                const textOverlaysToDuplicate = await deviceToDuplicate.getVideoTextOverlays();\n\n                for (const [overlayId, data] of Object.entries(textOverlaysToDuplicate)) {\n                    const canDuplicate = deviceToDuplicate.pluginId === this.cameraDevice.pluginId ||\n                        this.overlays.some(overlay => overlayId === overlay.id);\n\n                    if (!canDuplicate) {\n                        continue;\n                    }\n\n                    const { device, type, regex, maxDecimals, sensorId, sensorName, unit, text, template, updateFrequency, maxCharacters } = getOverlay({\n                        overlayId,\n                        storageSettings: this.plugin.mixinsMap[deviceId].storageSettings\n                    });\n                    const {\n                        deviceKey,\n                        typeKey,\n                        regexKey,\n                        maxDecimalsKey,\n                        sensorIdKey,\n                        sensorNameKey,\n                        unitKey,\n                        templateKey,\n                        updateFrequencyKey,\n                        textKey,\n                        maxCharactersKey\n                    } = getOverlayKeys(overlayId);\n\n                    await this.putMixinSetting(deviceKey, device);\n                    await this.putMixinSetting(typeKey, type);\n                    await this.putMixinSetting(regexKey, regex);\n                    await this.putMixinSetting(sensorIdKey, sensorId);\n                    await this.putMixinSetting(sensorNameKey, sensorName);\n                    await this.putMixinSetting(unitKey, unit);\n                    await this.putMixinSetting(templateKey, template);\n                    await this.putMixinSetting(updateFrequencyKey, String(updateFrequency));\n                    await this.putMixinSetting(textKey, text);\n                    await this.putMixinSetting(maxDecimalsKey, String(maxDecimals));\n                    await this.putMixinSetting(maxCharactersKey, String(maxCharacters));\n                }\n\n                await this.putMixinSetting('duplicateFromDevice', undefined);\n                await this.refreshSettings();\n            }\n        } catch (e) {\n            logger.error(`Error in duplicateFromDevice`, e);\n        }\n    }\n\n    private limitText(props: { overlayId: string, text: string }) {\n        const { overlayId, text } = props;\n\n        const overlay = getOverlay({ overlayId, storageSettings: this.storageSettings });\n        const { maxCharacters } = overlay;\n\n        if (!maxCharacters) {\n            return text;\n        } else {\n            if (text.length <= maxCharacters) {\n                return text;\n            } else {\n                return `${text.substring(0, maxCharacters - 3)}...`;\n            }\n        }\n    }\n\n    private updateOverlayDataFromTemplate = async (props: {\n        overlayId: string,\n        template: string,\n    }) => {\n        const logger = this.getLogger();\n        const { overlayId, template } = props;\n        const { devicesKey, parserStringKey, } = getTemplateKeys(template);\n        const deviceIds = JSON.parse(this.plugin.storage.getItem(devicesKey) ?? '[]');\n        let parserString = this.plugin.storage.getItem(parserStringKey) || '';\n\n        try {\n            for (const deviceId of deviceIds) {\n                const device = sdk.systemManager.getDeviceById(deviceId);\n                if (!device) {\n                    logger.log(`Device ${deviceId} not found.`);\n                    continue;\n                }\n                parserString = await this.applyDeviceTemplate(parserString, device, template);\n            }\n        } catch (e) {\n            logger.log('Error parsing template', e);\n        }\n\n        logger.debug(`Updating overlay ${overlayId} with ${parserString}`);\n        await this.cameraDevice.setVideoTextOverlay(overlayId, { text: this.limitText({ overlayId, text: parserString }) });\n    }\n\n    private async applyDeviceTemplate(\n        templateString: string,\n        device: any,\n        template: string\n    ): Promise<string> {\n        const { getDeviceKeys, getSensorKeys } = getTemplateKeys(template);\n\n        if (device.interfaces.includes(ScryptedInterface.Sensors)) {\n            const { sensorsKey } = getDeviceKeys(device.id);\n            const selectedSensorIds = JSON.parse(this.plugin.storage.getItem(sensorsKey) ?? '[]');\n            for (const sensorId of selectedSensorIds) {\n                const sensorData = device.sensors[sensorId];\n                const { maxDecimalsKey, unitKey } = getSensorKeys(sensorId);\n                const sensorUnit = this.plugin.storage.getItem(unitKey);\n                const maxDecimals = this.plugin.storageSettings.getItem(maxDecimalsKey) ?? 1;\n                const replaceString = `{${device.id}.${sensorId}}`;\n                const unit = sensorUnit ?? sensorData?.unit;\n                let value = sensorData?.value;\n                if (typeof value === 'number') {\n                    const localValue = UnitConverter.siToLocal(value, unit as Unit);\n                    value = formatValue(localValue, maxDecimals);\n                }\n                templateString = templateString.replaceAll(replaceString, String(value));\n            }\n        }\n        else {\n            const strippedNativeId = getStrippedNativeId(device);\n            const replaceString = `{${device.id}.${strippedNativeId}}`;\n            let value: any;\n            let unit: any;\n            let maxDecimals = 1;\n\n            if (device.interfaces.includes(ScryptedInterface.Thermometer)) {\n                const sensorKeys = getSensorKeys('temperature');\n                maxDecimals = this.plugin.storageSettings.getItem(sensorKeys.maxDecimalsKey) ?? 1;\n                value = device.temperature;\n                unit = device.temperatureUnit;\n                if (unit === TemperatureUnit.F) {\n                    value = value * 9 / 5 + 32;\n                }\n            }\n            else if (device.interfaces.includes(ScryptedInterface.HumiditySensor)) {\n                const sensorKeys = getSensorKeys('humidity');\n                maxDecimals = this.plugin.storageSettings.getItem(sensorKeys.maxDecimalsKey) ?? 1;\n                value = device.humidity;\n                unit = '%';\n            }\n            else if (device.interfaces.includes(ScryptedInterface.EntrySensor)) {\n                value = getEntryText(device.entryOpen, this.plugin);\n            }\n            else if (device.interfaces.includes(ScryptedInterface.Lock)) {\n                value = getLockText(device.lockState, this.plugin);\n            }\n            else if (device.interfaces.includes(ScryptedInterface.BinarySensor)) {\n                value = device.binaryState ? 'On' : 'Off';\n            }\n\n            if (typeof value === 'number') {\n                const localValue = UnitConverter.siToLocal(value, unit);\n                value = formatValue(localValue, maxDecimals);\n            }\n            templateString = templateString.replaceAll(replaceString, String(value));\n        }\n\n        return templateString;\n    }\n\n    private updateOverlayData = async (props: {\n        overlayId: string,\n        listenerType: ListenerType,\n        listenInterface?: ScryptedInterface | string,\n        data: any,\n    }) => {\n        const logger = this.getLogger();\n        const { overlayId, listenerType, data } = props;\n\n        if (this.cameraDevice.sleeping) {\n            return;\n        }\n\n        try {\n            const overlay = getOverlay({ overlayId, storageSettings: this.storageSettings });\n            const { textToUpdate, value } = parseOverlayData({ data, listenerType, overlay, plugin: this.plugin, logger });\n\n            if (value == undefined && listenerType === ListenerType.Face) {\n                return;\n            }\n\n            logger.debug(`Setting overlay data ${overlayId}: ${JSON.stringify({\n                listenerType,\n                data,\n                textToUpdate\n            })}`);\n\n            if (listenerType === ListenerType.Face) {\n                this.storageSettings.putSetting('lastFace', value);\n            }\n\n            if (textToUpdate) {\n                await this.cameraDevice.setVideoTextOverlay(overlayId, { text: this.limitText({ overlayId, text: textToUpdate }) });\n            } else if (overlay.type === OverlayType.Disabled) {\n                await this.cameraDevice.setVideoTextOverlay(overlayId, { text: false });\n            }\n        } catch (e) {\n            logger.error('Error in updateOverlayData', e);\n        }\n    }\n\n    async start() {\n        const logger = this.getLogger();\n        for (const cameraOverlay of this.overlays) {\n            const overlayId = cameraOverlay.id;\n            const overlay = getOverlay({\n                overlayId,\n                storageSettings: this.storageSettings\n            });\n\n            const overlayType = overlay.type;\n            let listenerType: ListenerType;\n            let listenInterface: ScryptedInterface | string;\n            let deviceId: string;\n\n            if (overlayType === OverlayType.Device) {\n                const realDevice = sdk.systemManager.getDeviceById<Sensors>(overlay.device);\n\n                if (realDevice) {\n                    if (realDevice.interfaces.includes(ScryptedInterface.Sensors)) {\n                        if (overlay.sensorName) {\n                            const sensorId = overlay.sensorId ?? Object.entries(realDevice.sensors)\n                                .find(([_, { name }]) => name === overlay.sensorName)?.[0];\n\n                            listenerType = ListenerType.Sensors;\n                            listenInterface = sensorId;\n                            deviceId = overlay.device;\n                        }\n                    } else if (realDevice.interfaces.includes(ScryptedInterface.Thermometer)) {\n                        listenerType = ListenerType.Temperature;\n                        listenInterface = ScryptedInterface.Thermometer;\n                        deviceId = overlay.device;\n                    } else if (realDevice.interfaces.includes(ScryptedInterface.HumiditySensor)) {\n                        listenerType = ListenerType.Humidity;\n                        listenInterface = ScryptedInterface.HumiditySensor;\n                        deviceId = overlay.device;\n                    } else if (realDevice.interfaces.includes(ScryptedInterface.Lock)) {\n                        listenerType = ListenerType.Lock;\n                        listenInterface = ScryptedInterface.Lock;\n                        deviceId = overlay.device;\n                    } else if (realDevice.interfaces.includes(ScryptedInterface.EntrySensor)) {\n                        listenerType = ListenerType.Entry;\n                        listenInterface = ScryptedInterface.EntrySensor;\n                        deviceId = overlay.device;\n                    }\n                } else {\n                    logger.log(`Device ${overlay.device} not found`);\n                }\n            } else if (overlayType === OverlayType.FaceDetection) {\n                listenerType = ListenerType.Face;\n                listenInterface = ScryptedInterface.ObjectDetector;\n                deviceId = this.id;\n            } else if (overlayType === OverlayType.BatteryLeft) {\n                listenerType = ListenerType.Battery;\n                listenInterface = ScryptedInterface.Battery;\n                deviceId = this.id;\n            }\n\n            logger.log(`Settings for overlay ${overlayId}: ${JSON.stringify({ overlay, overlayType, listenerType, listenInterface, deviceId })}`);\n            this.listenersMap[overlayId]?.listener && this.listenersMap[overlayId].listener.removeListener();\n            this.listenersMap[overlayId]?.interval && clearInterval(this.listenersMap[overlayId].interval);\n\n            if (listenerType) {\n                if (listenInterface && deviceId) {\n                    const realDevice = sdk.systemManager.getDeviceById<ScryptedDeviceBase>(deviceId);\n                    logger.log(`Overlay ${overlayId}: starting device ${realDevice.name} listener for type ${listenerType} on interface ${listenInterface}`);\n                    const update = async (data: any) => await this.updateOverlayData({\n                        listenInterface,\n                        overlayId,\n                        data,\n                        listenerType,\n                    });\n                    const newListener = realDevice.listen(listenInterface, async (_, __, data) => {\n                        await update(data);\n                    });\n\n                    if (listenerType === ListenerType.Sensors) {\n                        update(realDevice.sensors?.[listenInterface]);\n                    } else if (listenInterface === ScryptedInterface.Thermometer) {\n                        update(realDevice.temperature);\n                    } else if (listenInterface === ScryptedInterface.HumiditySensor) {\n                        update(realDevice.humidity);\n                    } else if (listenInterface === ScryptedInterface.Lock) {\n                        update(realDevice.lockState);\n                    } else if (listenInterface === ScryptedInterface.EntrySensor) {\n                        update(realDevice.entryOpen);\n                    } else if (listenInterface === ScryptedInterface.Battery) {\n                        update(realDevice.batteryLevel);\n                    } else if (listenInterface === ScryptedInterface.ObjectDetector) {\n                        update({ detections: [{ className: 'face', label: this.storageSettings.values.lastFace || '-' }] } as ObjectsDetected);\n                    }\n\n                    this.listenersMap[overlayId] = {\n                        listenerType,\n                        device: overlay.device,\n                        listener: newListener\n                    };\n                }\n            } else if (overlayType === OverlayType.Text) {\n                this.updateOverlayData({\n                    overlayId,\n                    listenerType,\n                    data: overlay.text,\n                });\n            } else if (overlayType === OverlayType.Disabled) {\n                this.updateOverlayData({\n                    overlayId,\n                    listenerType,\n                    data: '',\n                });\n            } else if (overlayType === OverlayType.Template && overlay.template) {\n                logger.log(`Overlay ${overlayId}: interval to update the template ${overlay.template}`);\n\n                const newListener = setInterval(async () => {\n                    await this.updateOverlayDataFromTemplate({ overlayId, template: overlay.template });\n                }, overlay.updateFrequency * 1000)\n\n                this.listenersMap[overlayId] = {\n                    listenerType: ListenerType.Interval,\n                    interval: newListener\n                };\n            }\n\n            // if (this.cameraDevice.interfaces.includes(ScryptedInterface.Sleep)) {\n            //     const realDevice = sdk.systemManager.getDeviceById<ScryptedDeviceBase>(this.id);\n            //     this.listenersMap[ScryptedInterface.Sleep] = {\n            //         listener: realDevice.listen(ScryptedInterface.Sleep, async (_, __, data) => {\n            //             this.console.log('Camera woke up, updating ovelays', data);\n            //         }),\n            //         listenerType: ListenerType.Battery,\n            //         device: this.id\n            //     }\n            // }\n        }\n    }\n\n    async init() {\n        const logger = this.getLogger();\n        try {\n            await this.refreshSettings();\n        } catch (e) {\n            logger.error('Error in init', e);\n        }\n    }\n}","import sdk, { Settings, DeviceBase, MixinProvider, ScryptedDeviceBase, ScryptedDeviceType, ScryptedInterface, WritableDeviceState, Setting, SettingValue, DeviceInformation, Sensors } from \"@scrypted/sdk\";\nimport OsdManagerMixin from \"./cameraMixin\";\nimport { convertSettingsToStorageSettings, deviceFilter, getStrippedNativeId, getTemplateKeys, osdManagerPrefix, SupportedDevice } from \"./utils\";\nimport { StorageSetting, StorageSettings, StorageSettingsDict } from \"@scrypted/sdk/storage-settings\";\nimport { template } from \"lodash\";\nimport { UnitConverter } from \"../../scrypted-homeassistant/src/unitConverter\";\n\nexport default class OsdManagerProvider extends ScryptedDeviceBase implements MixinProvider, Settings {\n    initStorage: StorageSettingsDict<string> = {\n        lockText: {\n            title: 'Locked State Text',\n            type: 'string',\n            defaultValue: 'Locked',\n        },\n        unlockText: {\n            title: 'Unlocked State Text',\n            type: 'string',\n            defaultValue: 'Unlocked',\n        },\n        openText: {\n            title: 'Open State Text',\n            type: 'string',\n            defaultValue: 'Open',\n        },\n        closedText: {\n            title: 'Closed State Text',\n            type: 'string',\n            defaultValue: 'Closed',\n        },\n        jammedText: {\n            title: 'Jammed State Text',\n            type: 'string',\n            defaultValue: 'Jammed',\n        },\n        templates: {\n            title: 'Templates',\n            description: 'Define templates from multiple devices',\n            type: 'string',\n            multiple: true,\n            defaultValue: [],\n            choices: [],\n            combobox: true,\n            onPut: () => this.refreshSettings()\n        },\n    };\n    storageSettings = new StorageSettings(this, this.initStorage);\n\n    public mixinsMap: Record<string, OsdManagerMixin> = {};\n\n    constructor(nativeId: string) {\n        super(nativeId);\n\n        this.refreshSettings().catch();\n    }\n\n    async refreshSettings() {\n        const dynamicSettings: StorageSetting[] = [];\n        const { templates } = this.storageSettings.values;\n    \n        for (const templateId of templates) {\n            const {\n                devicesKey,\n                getSensorKeys,\n                getDeviceKeys,\n                group,\n                parserStringKey,\n            } = getTemplateKeys(templateId);\n    \n            dynamicSettings.push(\n                {\n                key: devicesKey,\n                title: 'Device',\n                type: 'device',\n                group,\n                deviceFilter,\n                multiple: true,\n                onPut: this.refreshSettings,\n                },\n            );\n    \n            const deviceIds = JSON.parse(this.storage.getItem(devicesKey) ?? '[]');\n            const availableSensorIds: string[] = [];\n    \n            for (const deviceId of deviceIds) {\n                const device = sdk.systemManager.getDeviceById(deviceId) as unknown as ScryptedDeviceBase;\n                if (device && device.interfaces.includes(ScryptedInterface.Sensors)) {\n                    const sensorDevice = device as unknown as Sensors;\n                    const { sensorsKey } = getDeviceKeys(deviceId);\n                    const sensorIds = Object.keys(sensorDevice.sensors ?? {});\n                    dynamicSettings.push({\n                        key: sensorsKey,\n                        title: `Available sensors on device \"${device.name}\"`,\n                        description: `Select the sensors to make available on the template. Access it on the parser with \"{${deviceId}.sensorName}\"`,\n                        type: 'string',\n                        group,\n                        choices: sensorIds,\n                        immediate: true,\n                        combobox: true,\n                        multiple: true,\n                        onPut: this.refreshSettings,\n                    });\n    \n                    const selectedSensorIds = JSON.parse(this.storage.getItem(sensorsKey) ?? '[]');\n                    for (const sensorId of selectedSensorIds) {\n                        availableSensorIds.push(`{${device.id}.${sensorId}}`);\n\n                        const { maxDecimalsKey, unitKey } = getSensorKeys(sensorId);\n                        const sensorData = sensorDevice.sensors[sensorId];\n                        const unit = sensorData?.unit;\n\n                        if (unit) {\n                            const possibleUnits = UnitConverter.getUnits(unit);\n\n                        dynamicSettings.push(\n                            {\n                                key: unitKey,\n                                title: 'Unit',\n                                type: 'string',\n                                subgroup: sensorId,\n                                defaultValue: possibleUnits[0],\n                                group,\n                                immediate: true,\n                                choices: possibleUnits,\n                            },\n                        )\n                        }\n\n                    dynamicSettings.push(\n                        {\n                            key: maxDecimalsKey,\n                            title: 'Max Decimals',\n                            type: 'number',\n                            subgroup: sensorId,\n                            defaultValue: 1,\n                            group,\n                        });\n                    }\n                } else if (device) {\n                    const strippedNativeId = getStrippedNativeId(device);         \n                    availableSensorIds.push(`{${device.id}.${strippedNativeId}}`);\n                    if (device.interfaces.includes(ScryptedInterface.Thermometer)) {\n                        const thermoDevice = device as any; \n                        const { maxDecimalsKey, unitKey } = getSensorKeys('temperature');\n                        const sensorData = { value: thermoDevice.temperature, unit: thermoDevice.temperatureUnit };\n                        if (sensorData.unit) {\n                            const possibleUnits = UnitConverter.getUnits(sensorData.unit);\n                            dynamicSettings.push({\n                                key: unitKey,\n                                title: 'Unit',\n                                type: 'string',\n                                subgroup: 'temperature',\n                                defaultValue: possibleUnits[0],\n                                group,\n                                immediate: true,\n                                choices: possibleUnits,\n                            });\n                        }\n                        dynamicSettings.push({\n                            key: maxDecimalsKey,\n                            title: 'Max Decimals',\n                            type: 'number',\n                            subgroup: 'temperature',\n                            defaultValue: 1,\n                            group,\n                        });\n                    } else if (device.interfaces.includes(ScryptedInterface.HumiditySensor)) {\n                        const humidityDevice = device as any; // Treat as HumiditySensor\n                        const { maxDecimalsKey, unitKey } = getSensorKeys('humidity');\n                        const sensorData = { value: humidityDevice.humidity, unit: '%' };\n                        dynamicSettings.push({\n                            key: unitKey,\n                            title: 'Unit',\n                            type: 'string',\n                            subgroup: 'humidity',\n                            defaultValue: '%',\n                            group,\n                            immediate: true,\n                            choices: ['%'],\n                        });\n                        dynamicSettings.push({\n                            key: maxDecimalsKey,\n                            title: 'Max Decimals',\n                            type: 'number',\n                            subgroup: 'humidity',\n                            defaultValue: 1,\n                            group,\n                        });\n                    }\n                } else {\n                    this.console.warn(`Device ${deviceId} not found`);\n                }\n            }\n    \n            dynamicSettings.push(\n                {\n                    key: parserStringKey,\n                    title: 'Parser',\n                    description: `String used to generate the content. Available variables: ${availableSensorIds.join(', ')}`,\n                    type: 'textarea',\n                    group,\n                },\n            );\n        }\n    \n        this.storageSettings = await convertSettingsToStorageSettings({\n            device: this,\n            dynamicSettings,\n            initStorage: this.initStorage\n        });\n\n    }\n    \n    async getSettings(): Promise<Setting[]> {\n        return this.storageSettings.getSettings();\n    }\n\n    putSetting(key: string, value: SettingValue): Promise<void> {\n        return this.storageSettings.putSetting(key, value);\n    }\n\n    async canMixin(type: ScryptedDeviceType, interfaces: string[]): Promise<string[]> {\n        return interfaces.includes(ScryptedInterface.VideoTextOverlays) ?\n            [\n                ScryptedInterface.Settings,\n            ] :\n            undefined;\n    }\n\n    async getMixin(mixinDevice: DeviceBase, mixinDeviceInterfaces: ScryptedInterface[], mixinDeviceState: WritableDeviceState): Promise<any> {\n        return new OsdManagerMixin(\n            {\n                mixinDevice,\n                mixinDeviceInterfaces,\n                mixinDeviceState,\n                mixinProviderNativeId: this.nativeId,\n                group: 'OSD manager',\n                groupKey: osdManagerPrefix,\n            },\n            this);\n    }\n\n    async releaseMixin(id: string, mixinDevice: any): Promise<void> {\n        await mixinDevice.release();\n    }\n}","import sdk, { EventListenerRegister, HumiditySensor, Lock, LockState, ObjectsDetected, ScryptedDeviceBase, ScryptedInterface, Sensors, TemperatureUnit, Thermometer, VideoTextOverlay } from \"@scrypted/sdk\";\nimport { StorageSetting, StorageSettings, StorageSettingsDevice, StorageSettingsDict } from \"@scrypted/sdk/storage-settings\";\nimport { UnitConverter } from '../../scrypted-homeassistant/src/unitConverter';\nimport { CameraType } from \"./cameraMixin\";\nimport OsdManagerProvider from \"./main\";\n\nexport const deviceFilter = `['${ScryptedInterface.Thermometer}','${ScryptedInterface.HumiditySensor}','${ScryptedInterface.Lock}','${ScryptedInterface.EntrySensor}','${ScryptedInterface.Sensors}'].some(elem => interfaces.includes(elem))`;\nexport const pluginEnabledFilter = `interfaces.includes('${ScryptedInterface.VideoTextOverlays}')`;\nexport const osdManagerPrefix = 'osdManager';\n\nexport type CameraOverlay = VideoTextOverlay & { id: string };\nexport type SupportedDevice = ScryptedDeviceBase & (Thermometer | HumiditySensor | Lock) & Sensors;\nexport enum OverlayType {\n    Disabled = 'Disabled',\n    Text = 'Text',\n    Device = 'Device',\n    Template = 'Template',\n    FaceDetection = 'FaceDetection',\n    BatteryLeft = 'BatteryLeft',\n}\n\nexport interface Overlay {\n    currentText: string;\n    text: string;\n    type: OverlayType;\n    device: string;\n    regex: string;\n    maxCharacters?: number;\n    maxDecimals: number;\n    unit?: string;\n    sensorId?: string;\n    sensorName?: string;\n    template?: string;\n    updateFrequency?: number;\n}\n\nexport enum ListenerType {\n    Face = 'Face',\n    Humidity = 'Humidity',\n    Temperature = 'Temperature',\n    Lock = 'Lock',\n    Battery = 'Battery',\n    Sleep = 'Sleep',\n    Entry = 'Entry',\n    Sensors = 'Sensors',\n    Interval = 'Interval',\n}\n\nexport type ListenersMap = Record<string, {\n    listenerType: ListenerType,\n    listener?: EventListenerRegister,\n    interval?: NodeJS.Timeout,\n    device?: string\n}>;\n\nexport const getFriendlyTitle = (props: {\n    rawTitle: string,\n    device: CameraType,\n}) => {\n    const { device, rawTitle } = props;\n    if (device.pluginId === '@scrypted/amcrest') {\n        return rawTitle\n            .replace(/^table\\.VideoWidget\\[\\d+\\]\\./, '');\n    } else {\n        return `Overlay ${rawTitle}`;\n    }\n}\n\nexport const getTemplateKeys = (templateId: string) => {\n    const group = `Template: ${templateId}`;\n    const devicesKey = `template:${templateId}:devices`;\n    const scriptKey = `template:${templateId}:script`;\n    const parserStringKey = `template:${templateId}:parserString`;\n    const getDeviceKeys = (deviceId: string) => {\n        const sensorsKey = `overlay:${templateId}:${deviceId}:sensors`;\n\n        return {\n            sensorsKey,\n        };\n    };\n    const getSensorKeys = (sensorId: string) => {\n        const maxDecimalsKey = `overlay:${templateId}:${sensorId}:maxDecimals`;\n        const unitKey = `overlay:${templateId}:${sensorId}:unit`;\n\n        return {\n            maxDecimalsKey,\n            unitKey,\n        };\n    };\n\n    return {\n        group,\n        devicesKey,\n        scriptKey,\n        parserStringKey,\n        getSensorKeys,\n        getDeviceKeys,\n    }\n}\n\nexport const getOverlayKeys = (overlayId: string) => {\n    const currentTextKey = `overlay:${overlayId}:currentText`;\n    const textKey = `overlay:${overlayId}:text`;\n    const typeKey = `overlay:${overlayId}:type`;\n    const regexKey = `overlay:${overlayId}:regex`;\n    const deviceKey = `overlay:${overlayId}:device`;\n    const templateKey = `overlay:${overlayId}:template`;\n    const maxCharactersKey = `overlay:${overlayId}:maxCharacters`;\n    const maxDecimalsKey = `overlay:${overlayId}:maxDecimals`;\n    const sensorIdKey = `overlay:${overlayId}:sensorId`;\n    const sensorNameKey = `overlay:${overlayId}:sensorName`;\n    const unitKey = `overlay:${overlayId}:unit`;\n    const updateFrequencyKey = `overlay:${overlayId}:updateFrequency`;\n\n    return {\n        currentTextKey,\n        textKey,\n        typeKey,\n        regexKey,\n        deviceKey,\n        maxCharactersKey,\n        maxDecimalsKey,\n        sensorIdKey,\n        sensorNameKey,\n        templateKey,\n        unitKey,\n        updateFrequencyKey,\n    }\n}\n\nexport const getOverlaySettings = (props: {\n    storage: StorageSettings<any>,\n    overlays: CameraOverlay[],\n    templates: string[],\n    logger: Console,\n    device: CameraType,\n    onSettingUpdated: () => Promise<void>\n}) => {\n    const { storage, templates, overlays, device, onSettingUpdated, logger } = props;\n    const settings: StorageSetting[] = [];\n\n    for (const overlay of overlays) {\n        const rawTitle = `${overlay.id}`;\n        const friendlyTitle = getFriendlyTitle({\n            rawTitle,\n            device,\n        });\n        const overlayName = friendlyTitle;\n\n        const {\n            deviceKey,\n            typeKey,\n            regexKey,\n            textKey,\n            maxCharactersKey,\n            maxDecimalsKey,\n            sensorNameKey,\n            unitKey,\n            templateKey,\n            updateFrequencyKey,\n        } = getOverlayKeys(overlay.id);\n\n        if (overlay.readonly) {\n            settings.push(\n                {\n                    title: 'Readonly',\n                    type: 'boolean',\n                    subgroup: overlayName,\n                    value: true,\n                    readonly: true,\n                }\n            );\n\n            continue;\n        }\n\n        const type = storage.getItem(typeKey) ?? OverlayType.Text;\n\n        settings.push(\n            {\n                key: typeKey,\n                title: 'Overlay Type',\n                type: 'string',\n                choices: Object.values(OverlayType),\n                defaultValue: OverlayType.Text,\n                subgroup: overlayName,\n                immediate: true,\n                onPut: onSettingUpdated\n            },\n            {\n                key: maxCharactersKey,\n                title: 'Max Characters',\n                type: 'number',\n                subgroup: overlayName,\n                onPut: onSettingUpdated\n            }\n        );\n\n        if (type === OverlayType.Disabled) {\n            continue;\n        }\n\n        if (type === OverlayType.Template) {\n            settings.push(\n                {\n                    key: templateKey,\n                    title: 'Template',\n                    type: 'string',\n                    subgroup: overlayName,\n                    immediate: true,\n                    choices: templates,\n                    onPut: onSettingUpdated\n                },\n                {\n                    key: updateFrequencyKey,\n                    title: 'Update frequency in seconds',\n                    type: 'number',\n                    subgroup: overlayName,\n                    defaultValue: 5,\n                    onPut: onSettingUpdated\n                }\n            );\n            continue;\n        }\n\n        if (type === OverlayType.Text) {\n            settings.push({\n                key: textKey,\n                title: 'Text',\n                type: 'string',\n                subgroup: overlayName,\n                onPut: onSettingUpdated\n            })\n        };\n\n        const regexSetting: StorageSetting = {\n            key: regexKey,\n            title: 'Value Regex',\n            description: 'Expression to generate the text. ${value} contains the value and ${unit} the unit',\n            type: 'string',\n            subgroup: overlayName,\n            placeholder: '${value} ${unit}',\n            defaultValue: '${value} ${unit}',\n            onPut: onSettingUpdated\n        };\n        const precisionSetting: StorageSetting = {\n            key: maxDecimalsKey,\n            title: 'Max Decimals',\n            type: 'number',\n            subgroup: overlayName,\n            defaultValue: 1,\n            onPut: onSettingUpdated\n        };\n\n        if (type === OverlayType.Device) {\n            settings.push(\n                {\n                    key: deviceKey,\n                    title: 'Device',\n                    type: 'device',\n                    subgroup: overlayName,\n                    deviceFilter,\n                    immediate: true,\n                    onPut: onSettingUpdated\n                },\n            );\n\n            const selectedDevice = storage.getItem(deviceKey) as ScryptedDeviceBase | string;\n            const selectedDeviceId = typeof selectedDevice === 'string' ? selectedDevice : selectedDevice?.id;\n            const actualDevice = selectedDeviceId ? sdk.systemManager.getDeviceById<ScryptedDeviceBase & Sensors>(selectedDeviceId) : undefined;\n\n            if (actualDevice?.interfaces.includes(ScryptedInterface.Sensors)) {\n                const sensors = Object.entries(actualDevice.sensors ?? {});\n                const sensorNames = sensors.map(([_, item]) => item.name).sort();\n                settings.push(\n                    {\n                        key: sensorNameKey,\n                        title: 'Sensor',\n                        type: 'string',\n                        subgroup: overlayName,\n                        immediate: true,\n                        choices: sensorNames,\n                        onPut: onSettingUpdated\n                    },\n                );\n\n                const selectedSensorName = storage.getItem(sensorNameKey) as string;\n                if (selectedSensorName) {\n                    const sensorFound = sensors.find(([_, { name }]) => name === selectedSensorName);\n                    if (sensorFound) {\n                        const { unit } = sensorFound[1];\n                        const possibleUnits = UnitConverter.getUnits(unit);\n                        settings.push(\n                            {\n                                key: unitKey,\n                                title: 'Unit',\n                                type: 'string',\n                                subgroup: overlayName,\n                                immediate: true,\n                                choices: possibleUnits,\n                                onPut: onSettingUpdated\n                            }\n                        );\n                    }\n                }\n            }\n\n            settings.push(\n                regexSetting,\n                precisionSetting,\n            );\n        } else if (type === OverlayType.FaceDetection) {\n            settings.push(regexSetting);\n        } else if (type === OverlayType.BatteryLeft) {\n            settings.push(regexSetting, precisionSetting);\n        }\n    }\n\n    return settings;\n}\n\nexport const getOverlay = (props: {\n    storageSettings: StorageSettings<string>,\n    overlayId: string\n}): Overlay => {\n    const { storageSettings, overlayId } = props;\n\n    const {\n        currentTextKey,\n        deviceKey,\n        typeKey,\n        regexKey,\n        textKey,\n        maxCharactersKey,\n        maxDecimalsKey,\n        sensorIdKey,\n        sensorNameKey,\n        unitKey,\n        updateFrequencyKey,\n        templateKey,\n    } = getOverlayKeys(overlayId);\n\n    const currentText = storageSettings.values[currentTextKey];\n    const type = storageSettings.values[typeKey];\n    const device = storageSettings.values[deviceKey]?.id;\n    const text = storageSettings.values[textKey];\n    const regex = storageSettings.values[regexKey];\n    const maxCharacters = storageSettings.values[maxCharactersKey];\n    const maxDecimals = storageSettings.values[maxDecimalsKey];\n    const sensorId = storageSettings.values[sensorIdKey];\n    const sensorName = storageSettings.values[sensorNameKey];\n    const unit = storageSettings.values[unitKey];\n    const updateFrequency = storageSettings.values[updateFrequencyKey];\n    const template = storageSettings.values[templateKey];\n\n    return {\n        currentText,\n        device,\n        type,\n        regex,\n        text,\n        maxCharacters,\n        maxDecimals,\n        sensorId,\n        sensorName,\n        unit,\n        template,\n        updateFrequency,\n    };\n}\n\nexport const formatValue = (value: any, maxDecimals: number) => {\n    const factor = Math.pow(10, maxDecimals);\n    return Math.floor(Number(value ?? 0) * factor) / factor;\n};\n\nexport const getEntryText = (data: any, plugin: OsdManagerProvider): string => {\n    return data === 'jammed'\n        ? plugin.storageSettings.values.jammedText\n        : (data ? plugin.storageSettings.values.openText : plugin.storageSettings.values.closedText);\n};\n\nexport const getLockText = (data: any, plugin: OsdManagerProvider): string => {\n    return data === 'jammed'\n        ? plugin.storageSettings.values.jammedText\n        : (data === LockState.Locked ? plugin.storageSettings.values.lockText : plugin.storageSettings.values.unlockText);\n};\n\nexport const parseOverlayData = (props: {\n    listenerType: ListenerType,\n    data: any,\n    overlay: Overlay,\n    plugin: OsdManagerProvider,\n    logger: Console,\n}) => {\n    const { listenerType, data, overlay, plugin } = props;\n    const { regex, text, device, maxDecimals } = overlay;\n    const realDevice = device ? sdk.systemManager.getDeviceById<SupportedDevice>(device) : undefined;\n\n    let value;\n    let unit;\n    let textToUpdate;\n    if (listenerType === ListenerType.Face) {\n        value = (data as ObjectsDetected)?.detections?.find(det => det.className === 'face')?.label;\n    } else if (listenerType === ListenerType.Temperature) {\n        unit = realDevice.temperatureUnit ?? TemperatureUnit.C;\n\n        value = data;\n        if (unit === TemperatureUnit.F) {\n            value = data * 9 / 5 + 32;\n        }\n\n        value = formatValue(value, maxDecimals);\n    } else if (listenerType === ListenerType.Humidity) {\n        value = formatValue(data, maxDecimals);\n        unit = '%';\n    } else if (listenerType === ListenerType.Battery) {\n        value = formatValue(data, maxDecimals);\n        unit = '%';\n    } else if (listenerType === ListenerType.Lock) {\n        value = getLockText(data, plugin);\n    } else if (listenerType === ListenerType.Entry) {\n        value = getEntryText(data, plugin);\n    } else if (listenerType === ListenerType.Sensors) {\n        if (typeof data === 'number') {\n            unit = overlay.unit;\n            value = formatValue(UnitConverter.siToLocal(data, unit), maxDecimals);\n        }\n        else {\n            unit = overlay.unit ?? data?.unit;\n            const localValue = UnitConverter.siToLocal(data?.value, unit);\n            value = formatValue(localValue, maxDecimals);\n        }\n    } else if (overlay.type === OverlayType.Text) {\n        textToUpdate = text;\n    }\n\n\n    if (value != undefined && regex) {\n        textToUpdate = regex\n            .replace('${value}', value ?? '')\n            .replace('${unit}', unit ?? '');\n    }\n\n    return { textToUpdate, value };\n}\n\nexport const convertSettingsToStorageSettings = async (props: {\n    device: StorageSettingsDevice,\n    dynamicSettings: StorageSetting[],\n    initStorage: StorageSettingsDict<string>\n}) => {\n    const { device, dynamicSettings, initStorage } = props;\n\n    const onPutToRestore: Record<string, any> = {};\n    Object.entries(initStorage).forEach(([key, setting]) => {\n        if (setting.onPut) {\n            onPutToRestore[key] = setting.onPut;\n        }\n    });\n\n    const settings: StorageSetting[] = await new StorageSettings(device, initStorage).getSettings();\n\n    settings.push(...dynamicSettings);\n\n    const deviceSettings: StorageSettingsDict<string> = {};\n\n    for (const setting of settings) {\n        const { value, key, onPut, ...rest } = setting;\n        deviceSettings[key] = {\n            ...rest,\n            value: rest.type === 'html' ? value : undefined\n        };\n        if (setting.onPut) {\n            deviceSettings[key].onPut = setting.onPut.bind(device)\n        }\n    }\n\n    const updateStorageSettings = new StorageSettings(device, deviceSettings);\n\n    Object.entries(onPutToRestore).forEach(([key, onPut]) => {\n        updateStorageSettings.settings[key].onPut = onPut;\n    });\n\n    return updateStorageSettings;\n}\n\nexport function getStrippedNativeId(device: ScryptedDeviceBase): string {\n    const parts = device.nativeId.split(':');\n    return parts.length > 1 ? parts[1] : parts[0];\n}","module.exports = require(\"module\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(927);\n"],"names":["__createBinding","this","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__exportStar","exports","p","prototype","hasOwnProperty","call","value","sdk","MixinDeviceBase","ScryptedDeviceBase","index_1","DeviceBase","constructor","nativeId","super","storage","_storage","deviceManager","getDeviceStorage","log","_log","getDeviceLogger","console","_console","getDeviceConsole","createMediaObject","data","mimeType","mediaManager","sourceId","id","getMediaObjectConsole","mediaObject","getMixinConsole","_lazyLoadDeviceState","_deviceState","getDeviceState","onDeviceEvent","eventInterface","eventData","options","_listeners","Set","mixinDevice","mixinDeviceInterfaces","mixinStorageSuffix","mixinDeviceState","systemManager","getDeviceById","mixinProviderNativeId","__rpcproxy_traps_all_properties","createDeviceState","setState","mixinStorageKey","getMixinStorage","onMixinEvent","manageListener","listener","add","release","l","removeListener","_createGetState","state","_createSetState","warn","field","values","ScryptedInterfaceProperty","set","loaded","process","env","SCRYPTED_SDK_ES_MODULE","SCRYPTED_SDK_MODULE","cjsModule","SCRYPTED_SDK_CJS_MODULE","sdkModule","assign","getScryptedStatic","e","runtimeAPI","pluginRuntimeAPI","endpointManager","pluginHostAPI","setScryptedInterfaceDescriptors","TYPES_VERSION","ScryptedInterfaceDescriptors","catch","error","__setModuleDefault","v","__importStar","mod","result","SettingsMixinDeviceBase","_1","default","settingsGroup","group","settingsGroupKey","groupKey","nextTick","ScryptedInterface","Settings","getSettings","settingsPromise","includes","mixinSettingsPromise","getMixinSettings","allSettings","settings","push","name","description","key","Math","random","toString","title","readonly","mixinSettings","setting","putSetting","prefix","startsWith","putMixinSetting","substring","length","StorageSettings","device","hasValue","keys","rawGet","getItem","type","JSON","parse","ret","onGet","entries","s","hide","getItemInternal","deviceFilter","onPut","mapPut","mapGet","oldValue","putSettingInternal","noStore","removeItem","setItem","stringify","rawDevice","readDefaultValue","multiple","n","parseFloat","isNaN","parseInt","json","parseValue","persistedDefaultValue","defaultValue","webpackEmptyContext","req","Error","code","resolve","module","ScryptedMimeTypes","MediaPlayerState","SecuritySystemObstruction","SecuritySystemMode","AirQuality","AirPurifierMode","AirPurifierStatus","ChargeState","LockState","PanTiltZoomMovement","ThermostatMode","TemperatureUnit","FanMode","HumidityMode","ScryptedDeviceType","ScryptedInterfaceMethod","UnitGroup","Unit","siUnitMap","None","NONE","Length","M","Pressure","PA","Temperature","C","Speed","M_S","UnitConverter","getUnit","unitSrc","UNITS_MAP","unit","unitData","factor","unitGroup","siToLocal","siValue","conversionFormula","eval","replaceAll","String","localToSi","localValue","getUnits","filter","map","F","KM_H","MI_H","MM","KM","IN","MI","HPA","BAR","OsdManagerMixin","plugin","initStorage","lastFace","enableDebug","immediate","duplicateFromDevice","pluginEnabledFilter","async","_","refreshOverlays","refreshSettings","storageSettings","overlays","listenersMap","updateOverlayDataFromTemplate","props","logger","getLogger","overlayId","template","devicesKey","parserStringKey","getTemplateKeys","deviceIds","parserString","deviceId","applyDeviceTemplate","debug","cameraDevice","setVideoTextOverlay","text","limitText","updateOverlayData","listenerType","sleeping","overlay","getOverlay","textToUpdate","parseOverlayData","ListenerType","Face","OverlayType","Disabled","mixinsMap","setTimeout","killed","init","removeListeners","forEach","interval","clearInterval","deviceConsole","message","optionalParams","now","Date","toLocaleString","getOverlayData","dynamicSettings","getOverlaySettings","templates","onSettingUpdated","convertSettingsToStorageSettings","start","rest","split","osdManagerPrefix","join","textOverlays","getVideoTextOverlays","currentText","currentTextKey","getOverlayKeys","deviceToDuplicate","textOverlaysToDuplicate","pluginId","some","regex","maxDecimals","sensorId","sensorName","updateFrequency","maxCharacters","deviceKey","typeKey","regexKey","maxDecimalsKey","sensorIdKey","sensorNameKey","unitKey","templateKey","updateFrequencyKey","textKey","maxCharactersKey","templateString","getDeviceKeys","getSensorKeys","interfaces","Sensors","sensorsKey","selectedSensorIds","sensorData","sensors","sensorUnit","replaceString","formatValue","strippedNativeId","getStrippedNativeId","Thermometer","sensorKeys","temperature","temperatureUnit","HumiditySensor","humidity","EntrySensor","getEntryText","entryOpen","Lock","getLockText","lockState","BinarySensor","binaryState","cameraOverlay","overlayType","listenInterface","Device","realDevice","find","Humidity","Entry","FaceDetection","ObjectDetector","BatteryLeft","Battery","update","newListener","listen","__","batteryLevel","detections","className","label","Text","Template","setInterval","Interval","OsdManagerProvider","lockText","unlockText","openText","closedText","jammedText","choices","combobox","templateId","availableSensorIds","sensorDevice","sensorIds","possibleUnits","subgroup","thermoDevice","humidityDevice","canMixin","VideoTextOverlays","getMixin","releaseMixin","parts","getFriendlyTitle","rawTitle","replace","scriptKey","overlayName","regexSetting","placeholder","precisionSetting","selectedDevice","selectedDeviceId","actualDevice","sensorNames","item","sort","selectedSensorName","sensorFound","pow","floor","Number","Locked","det","onPutToRestore","deviceSettings","bind","updateStorageSettings","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","obj","prop","__webpack_exports__"],"sourceRoot":""}